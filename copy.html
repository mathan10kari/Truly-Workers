<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Truley Workers - Sri Lanka's premier platform for hiring skilled professionals and finding employment opportunities">
    <title>Truley Workers | Sri Lanka's Professional Hiring Platform</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>

        /*animation */
        
        /*end of animation*/
     


@keyframes bodyAnimation {
  0% {
    background-color: #f0f0f0;
    transform: translateY(0);
  }
  50% {
    background-color: #d0d0d0;
    transform: translateY(-10px);
  }
  100% {
    background-color: #f0f0f0;
    transform: translateY(0);
  }
}
        /* General Styles */
        :root {
            --primary-color: #0056b3; /* Updated to a more professional blue */
            --secondary-color: #FF9933; /* Sri Lankan accent color */
            --dark-color: #2c3e50;
            --light-color: #f5f5f5;
            --success-color: #28a745;
            --danger-color: #dc3545;
            --warning-color: #ffc107;
            --text-color: #333;
            --text-light: #7f8c8d;
            --white: #ffffff;
            --shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            --transition: all 0.3s ease;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background-color: var(--light-color);
            color: var(--text-color);
            line-height: 1.6;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* Navigation Bar */
        nav {
            background-color: var(--dark-color);
            color: var(--white);
            padding: 0.8rem 2rem;
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: var(--shadow);
        }

        .navbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1200px;
            margin: 0 auto;
        }

        .logo a {
            color: var(--white);
            font-size: 1.5rem;
            font-weight: 700;
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .logo img {
            height: 30px;
            width: auto;
        }

        .menu {
            display: flex;
            list-style: none;
        }

        .menu li {
            margin-left: 1.5rem;
            position: relative;
        }

        .menu li a {
            color: var(--white);
            text-decoration: none;
            font-weight: 500;
            transition: var(--transition);
            padding: 0.5rem 0;
            display: flex;
            align-items: center;
            gap: 0.3rem;
        }

        .menu li a:hover {
            color: var(--secondary-color);
        }

        .menu li a i {
            font-size: 0.9rem;
        }

        .hamburger {
            display: none;
            cursor: pointer;
            font-size: 1.5rem;
        }

        /* Hero Section */
        .hero-image {
            background: linear-gradient(rgba(0, 0, 0, 0.7), rgba(0, 0, 0, 0.7)), url("https://images.pexels.com/photos/3184465/pexels-photo-3184465.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=2");
            height: 70vh;
            min-height: 500px;
            background-position: center;
            background-repeat: no-repeat;
            background-size: cover;
            position: relative;
            display: flex;
            justify-content: center;
            align-items: center;
            text-align: center;
            color: var(--white);
            padding: 0 1rem;
        }

        .hero-text {
            max-width: 800px;
            padding: 2rem;
            background-color: rgba(0, 0, 0, 0.6);
            border-radius: 10px;
        }

        .hero-text h1 {
            font-size: 2.5rem;
            margin-bottom: 1rem;
            line-height: 1.2;
        }

        .hero-text p {
            font-size: 1.1rem;
            margin-bottom: 2rem;
        }

        .hero-buttons {
            display: flex;
            justify-content: center;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .btn {
            display: inline-block;
            padding: 0.8rem 1.8rem;
            font-size: 1rem;
            font-weight: 600;
            text-align: center;
            text-decoration: none;
            border-radius: 5px;
            cursor: pointer;
            transition: var(--transition);
            border: none;
        }

        .btn-primary {
            background-color: var(--primary-color);
            color: var(--white);
        }

        .btn-primary:hover {
            background-color: #004494;
            transform: translateY(-2px);
        }

        .btn-secondary {
            background-color: var(--secondary-color);
            color: var(--dark-color);
        }

        .btn-secondary:hover {
            background-color: #e68a00;
            transform: translateY(-2px);
        }

        /* Stats Section */
        .stats-section {
            padding: 3rem 0;
            background-color: var(--primary-color);
            color: var(--white);
            text-align: center;
        }

        .stats-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 2rem;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 2rem;
            margin-top: 2rem;
        }

        .stat-card {
            background-color: rgba(255, 255, 255, 0.1);
            padding: 1.5rem;
            border-radius: 8px;
            transition: var(--transition);
        }

        .stat-card:hover {
            transform: translateY(-5px);
            background-color: rgba(255, 255, 255, 0.2);
        }

        .stat-card i {
            font-size: 2.5rem;
            margin-bottom: 1rem;
            color: var(--secondary-color);
        }

        .stat-card h3 {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
        }

        .stat-card p {
            font-size: 1rem;
            opacity: 0.9;
        }

        /* Carousel Section */
        .section-title {
            text-align: center;
            margin-bottom: 2rem;
            position: relative;
        }

        .section-title h2 {
            font-size: 2rem;
            color: var(--dark-color);
            display: inline-block;
            padding-bottom: 0.5rem;
        }

        .section-title h2::after {
            content: '';
            position: absolute;
            width: 70px;
            height: 3px;
            background-color: var(--secondary-color);
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
        }

        .carousel-section {
            padding: 4rem 0;
            background-color: var(--white);
        }

        .wrapper {
            max-width: 1200px;
            margin: 0 auto;
            position: relative;
            padding: 0 2rem;
        }

        .wrapper i {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            height: 46px;
            width: 46px;
            background: var(--white);
            border-radius: 50%;
            text-align: center;
            line-height: 46px;
            font-size: 1.2rem;
            cursor: pointer;
            box-shadow: var(--shadow);
            z-index: 1;
            color: var(--primary-color);
            transition: var(--transition);
        }

        .wrapper i:hover {
            background-color: var(--primary-color);
            color: var(--white);
        }

        .wrapper i:first-child {
            left: 10px;
        }

        .wrapper i:last-child {
            right: 10px;
        }

        .carousel {
            display: flex;
            gap: 20px;
            overflow-x: auto;
            scroll-behavior: smooth;
            scrollbar-width: none;
            padding: 20px 0;
        }

        .carousel::-webkit-scrollbar {
            display: none;
        }

        .carousel.dragging {
            scroll-behavior: auto;
            cursor: grab;
        }

        .carousel.dragging .card {
            pointer-events: none;
        }

        .card {
            flex: 0 0 auto;
            width: 280px;
            background: var(--white);
            border-radius: 8px;
            box-shadow: var(--shadow);
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            transition: var(--transition);
        }

        .card:hover {
            transform: translateY(-10px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
        }

        .card .img {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            overflow: hidden;
            margin-bottom: 15px;
            border: 3px solid var(--primary-color);
        }

        .card .img img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .card h2 {
            font-size: 1.2rem;
            margin-bottom: 10px;
            color: var(--dark-color);
        }

        .card span {
            color: var(--text-light);
            font-size: 0.9rem;
            margin-bottom: 15px;
            display: block;
        }

        .card .rating {
            color: var(--secondary-color);
            margin-bottom: 15px;
        }

        .card .btn {
            width: 100%;
            padding: 0.6rem;
            font-size: 0.9rem;
        }

        /* Popular Categories */
        .categories-section {
            padding: 4rem 0;
            background-color: var(--light-color);
        }

        .categories-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-top: 2rem;
        }

        .category-card {
            background: var(--white);
            border-radius: 8px;
            box-shadow: var(--shadow);
            padding: 1.5rem;
            text-align: center;
            transition: var(--transition);
            cursor: pointer;
        }

        .category-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
        }

        .category-card i {
            font-size: 2.5rem;
            color: var(--primary-color);
            margin-bottom: 1rem;
        }

        .category-card h3 {
            font-size: 1.2rem;
            margin-bottom: 0.5rem;
            color: var(--dark-color);
        }

        .category-card p {
            color: var(--text-light);
            font-size: 0.9rem;
        }

        /* Worker Registration Form */
        .body {
            padding: 4rem 0;
            background-color: var(--light-color);
            flex: 1;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            background: var(--white);
            border-radius: 10px;
            box-shadow: var(--shadow);
            overflow: hidden;
        }

        .left-section {
            flex: 1;
            padding: 3rem;
            background: linear-gradient(135deg, var(--primary-color), var(--dark-color));
            color: var(--white);
            display: flex;
            flex-direction: column;
            justify-content: center;
            position: relative;
            overflow: hidden;
        }

        .left-section::before {
            content: '';
            position: absolute;
            top: -50px;
            right: -50px;
            width: 200px;
            height: 200px;
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
        }

        .left-section::after {
            content: '';
            position: absolute;
            bottom: -80px;
            left: -80px;
            width: 250px;
            height: 250px;
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
        }

        .left-section h1 {
            font-size: 2rem;
            margin-bottom: 1.5rem;
            position: relative;
            z-index: 1;
        }

        .left-section p {
            font-size: 1rem;
            line-height: 1.6;
            margin-bottom: 1.5rem;
            position: relative;
            z-index: 1;
        }

        .left-section ul {
            list-style: none;
            position: relative;
            z-index: 1;
        }

        .left-section ul li {
            margin-bottom: 0.8rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .left-section ul li i {
            color: var(--secondary-color);
        }

        .right-section {
            flex: 1;
            padding: 3rem;
        }

        .right-section header {
            font-size: 1.8rem;
            color: var(--dark-color);
            margin-bottom: 1.5rem;
            text-align: center;
            font-weight: 600;
        }

        .form {
            display: flex;
            flex-direction: column;
            gap: 1.2rem;
        }

        .input-box {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .input-box label {
            font-weight: 500;
            color: var(--dark-color);
            font-size: 0.95rem;
        }

        .input-box label.required::after {
            content: ' *';
            color: var(--danger-color);
        }

        .input-box input,
        .input-box select,
        .input-box textarea {
            padding: 0.8rem 1rem;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 1rem;
            transition: var(--transition);
        }

        .input-box input:focus,
        .input-box select:focus,
        .input-box textarea:focus {
            border-color: var(--primary-color);
            outline: none;
            box-shadow: 0 0 0 3px rgba(0, 86, 179, 0.1);
        }

        .column {
            display: flex;
            gap: 1.2rem;
        }

        .column .input-box {
            flex: 1;
        }

        .gender-box {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .gender-box label {
            font-weight: 500;
            color: var(--dark-color);
            font-size: 0.95rem;
        }

        .gender-option {
            display: flex;
            gap: 1.5rem;
        }

        .gender {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .gender input[type="radio"] {
            accent-color: var(--primary-color);
        }

        .worker-category {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .worker-category label {
            font-weight: 500;
            color: var(--dark-color);
            font-size: 0.95rem;
        }

        .worker-category select {
            padding: 0.8rem 1rem;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 1rem;
        }

        button[type="submit"] {
            background-color: var(--primary-color);
            color: var(--white);
            border: none;
            padding: 1rem;
            font-size: 1rem;
            font-weight: 600;
            border-radius: 6px;
            cursor: pointer;
            transition: var(--transition);
            margin-top: 1rem;
        }

        button[type="submit"]:hover {
            background-color: #004494;
        }

        /* Job Posting Form */
        .job-posting-form {
            display: none;
        }

        /* Hired Workers Section */
        .hired-section, .jobs-section, .contact-section, .about-section, .testimonials-section {
            padding: 4rem 0;
            background-color: var(--white);
            display: none;
            flex: 1;
        }

        .hired-container, .jobs-container, .contact-container, .about-container, .testimonials-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 2rem;
        }

        .hired-container h2, .jobs-container h2, .contact-container h2, .about-container h2, .testimonials-container h2 {
            font-size: 2rem;
            color: var(--dark-color);
            margin-bottom: 2rem;
            text-align: center;
            position: relative;
        }

        .hired-container h2::after, .jobs-container h2::after, .contact-container h2::after, .about-container h2::after, .testimonials-container h2::after {
            content: '';
            position: absolute;
            width: 70px;
            height: 3px;
            background-color: var(--secondary-color);
            bottom: -10px;
            left: 50%;
            transform: translateX(-50%);
        }

        .hired-list, .jobs-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-top: 2rem;
        }

        .hired-card, .job-card {
            background: var(--white);
            border-radius: 8px;
            box-shadow: var(--shadow);
            padding: 1.5rem;
            display: flex;
            flex-direction: column;
            gap: 1rem;
            position: relative;
            transition: var(--transition);
            border: 1px solid #eee;
        }

        .hired-card:hover, .job-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
        }

        .hired-card h3, .job-card h3 {
            font-size: 1.2rem;
            color: var(--dark-color);
            border-bottom: 1px solid #eee;
            padding-bottom: 0.5rem;
        }

        .hired-card p, .job-card p {
            color: var(--text-light);
            font-size: 0.9rem;
        }

        .hired-card .worker-type, .job-card .job-type {
            background-color: var(--primary-color);
            color: var(--white);
            padding: 0.3rem 0.8rem;
            border-radius: 20px;
            font-size: 0.8rem;
            align-self: flex-start;
        }

        .action-buttons {
            display: flex;
            gap: 1rem;
            margin-top: 1rem;
        }

        .accept-btn, .decline-btn, .view-btn {
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 500;
            transition: var(--transition);
            font-size: 0.9rem;
            flex: 1;
            text-align: center;
        }

        .accept-btn {
            background-color: var(--success-color);
            color: var(--white);
        }

        .accept-btn:hover {
            background-color: #218838;
        }

        .decline-btn {
            background-color: var(--danger-color);
            color: var(--white);
        }

        .decline-btn:hover {
            background-color: #c82333;
        }

        .view-btn {
            background-color: var(--primary-color);
            color: var(--white);
        }

        .view-btn:hover {
            background-color: #004494;
        }

        /* About Section */
        .about-content {
            display: flex;
            gap: 3rem;
            align-items: center;
            margin-top: 2rem;
        }

        .about-text {
            flex: 1;
        }

        .about-image {
            flex: 1;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: var(--shadow);
        }

        .about-image img {
            width: 100%;
            height: auto;
            display: block;
        }

        /* Testimonials Section */
        .testimonials-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 2rem;
            margin-top: 2rem;
        }

        .testimonial-card {
            background: var(--white);
            border-radius: 8px;
            box-shadow: var(--shadow);
            padding: 1.5rem;
            transition: var(--transition);
            border: 1px solid #eee;
        }

        .testimonial-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
        }

        .testimonial-header {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .testimonial-avatar {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            overflow: hidden;
        }

        .testimonial-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .testimonial-info h4 {
            font-size: 1.1rem;
            color: var(--dark-color);
            margin-bottom: 0.2rem;
        }

        .testimonial-info p {
            color: var(--text-light);
            font-size: 0.9rem;
        }

        .testimonial-rating {
            color: var(--secondary-color);
            margin-bottom: 1rem;
        }

        .testimonial-text {
            color: var(--text-color);
            font-style: italic;
            line-height: 1.6;
        }

        /* Contact Section */
        .contact-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 2rem;
            margin-top: 3rem;
        }

        .contact-card {
            background: var(--light-color);
            padding: 1.5rem;
            border-radius: 8px;
            text-align: center;
            box-shadow: var(--shadow);
            transition: var(--transition);
        }

        .contact-card:hover {
            transform: translateY(-5px);
        }

        .contact-card i {
            font-size: 2rem;
            color: var(--primary-color);
            margin-bottom: 1rem;
        }

        .contact-card h3 {
            margin-bottom: 0.5rem;
            color: var(--dark-color);
        }

        .contact-card p {
            color: var(--text-light);
        }

        .contact-form {
            margin-top: 3rem;
            background: var(--white);
            padding: 2rem;
            border-radius: 8px;
            box-shadow: var(--shadow);
        }

        .form-row {
            display: flex;
            gap: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .form-group {
            flex: 1;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
            color: var(--dark-color);
        }

        .form-group input,
        .form-group textarea {
            width: 100%;
            padding: 0.8rem 1rem;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 1rem;
            transition: var(--transition);
        }

        .form-group textarea {
            min-height: 150px;
        }

        .form-group input:focus,
        .form-group textarea:focus {
            border-color: var(--primary-color);
            outline: none;
            box-shadow: 0 0 0 3px rgba(0, 86, 179, 0.1);
        }

        .submit-btn {
            background-color: var(--primary-color);
            color: var(--white);
            border: none;
            padding: 0.8rem 1.5rem;
            font-size: 1rem;
            font-weight: 600;
            border-radius: 6px;
            cursor: pointer;
            transition: var(--transition);
        }

        .submit-btn:hover {
            background-color: #004494;
        }

        /* Login Modal */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background-color: var(--white);
            margin: 10% auto;
            padding: 2.5rem;
            border-radius: 10px;
            width: 90%;
            max-width: 450px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            position: relative;
            animation: modalFadeIn 0.3s;
        }

        @keyframes modalFadeIn {
            from {
                opacity: 0;
                transform: translateY(-50px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .modal-header h2 {
            color: var(--dark-color);
            font-size: 1.8rem;
        }

        .close {
            font-size: 1.8rem;
            font-weight: bold;
            color: var(--text-light);
            cursor: pointer;
            transition: var(--transition);
        }

        .close:hover {
            color: var(--danger-color);
        }

        .login-form {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }

        .form-group {
            margin-bottom: 1rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
            color: var(--dark-color);
        }

        .form-group input {
            width: 100%;
            padding: 0.8rem 1rem;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 1rem;
            transition: var(--transition);
        }

        .form-group input:focus {
            border-color: var(--primary-color);
            outline: none;
            box-shadow: 0 0 0 3px rgba(0, 86, 179, 0.1);
        }

        .remember-forgot {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .remember-me {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .remember-me input {
            accent-color: var(--primary-color);
        }

        .forgot-password a {
            color: var(--primary-color);
            text-decoration: none;
            font-size: 0.9rem;
            transition: var(--transition);
        }

        .forgot-password a:hover {
            text-decoration: underline;
        }

        .login-form button {
            background-color: var(--primary-color);
            color: var(--white);
            border: none;
            padding: 0.8rem;
            border-radius: 6px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: var(--transition);
        }

        .login-form button:hover {
            background-color: #004494;
        }

        .register-link {
            text-align: center;
            margin-top: 1rem;
            font-size: 0.9rem;
        }

        .register-link a {
            color: var(--primary-color);
            text-decoration: none;
            font-weight: 500;
            transition: var(--transition);
        }

        .register-link a:hover {
            text-decoration: underline;
        }

        /* Confirmation Modal */
        .confirmation-modal {
            display: none;
            position: fixed;
            z-index: 1001;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(5px);
        }

        .confirmation-content {
            background-color: var(--white);
            margin: 20% auto;
            padding: 2rem;
            border-radius: 10px;
            width: 90%;
            max-width: 400px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            text-align: center;
            animation: modalFadeIn 0.3s;
        }

        .confirmation-content h3 {
            font-size: 1.3rem;
            color: var(--dark-color);
            margin-bottom: 1rem;
        }

        .confirmation-content p {
            color: var(--text-light);
            margin-bottom: 1.5rem;
        }

        .confirmation-buttons {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin-top: 1.5rem;
        }

        .confirmation-buttons button {
            padding: 0.6rem 1.2rem;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 500;
            transition: var(--transition);
            min-width: 100px;
        }

        .confirm-btn {
            background-color: var(--danger-color);
            color: var(--white);
        }

        .confirm-btn:hover {
            background-color: #c82333;
        }

        .cancel-btn {
            background-color: var(--text-light);
            color: var(--white);
        }

        .cancel-btn:hover {
            background-color: #6c757d;
        }

        /* Feedback Modal */
        .feedback-modal {
            display: none;
            position: fixed;
            z-index: 1002;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(5px);
        }

        .feedback-content {
            background-color: var(--white);
            margin: 10% auto;
            padding: 2.5rem;
            border-radius: 10px;
            width: 90%;
            max-width: 500px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            animation: modalFadeIn 0.3s;
        }

        .feedback-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .feedback-header h2 {
            color: var(--dark-color);
            font-size: 1.8rem;
        }

        .close-feedback {
            font-size: 1.8rem;
            font-weight: bold;
            color: var(--text-light);
            cursor: pointer;
            transition: var(--transition);
        }

        .close-feedback:hover {
            color: var(--danger-color);
        }

        .feedback-form {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }

        .feedback-form .input-box {
            margin-bottom: 1rem;
        }

        .feedback-form button {
            background-color: var(--primary-color);
            color: var(--white);
            border: none;
            padding: 0.8rem;
            border-radius: 6px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: var(--transition);
        }

        .feedback-form button:hover {
            background-color: #004494;
        }

        /* Success Message */
        .success-message {
            display: none;
            position: fixed;
            top: 20px;
            right: 20px;
            background-color: var(--success-color);
            color: var(--white);
            padding: 1rem 1.5rem;
            border-radius: 6px;
            box-shadow: var(--shadow);
            z-index: 1003;
            animation: slideIn 0.3s, slideOut 0.3s 2.7s forwards;
        }

        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        @keyframes slideOut {
            from {
                transform: translateX(0);
                opacity: 1;
            }
            to {
                transform: translateX(100%);
                opacity: 0;
            }
        }

        /* Footer */
        footer {
            background-color: var(--dark-color);
            color: var(--white);
            padding: 3rem 0 1.5rem;
            text-align: center;
            margin-top: auto;
        }

        .footer-content {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            flex-direction: column;
            gap: 2rem;
            padding: 0 2rem;
        }

        .footer-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 2rem;
            text-align: left;
        }

        .footer-logo {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .footer-logo a {
            color: var(--white);
            font-size: 1.5rem;
            font-weight: 700;
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .footer-logo p {
            color: #bdc3c7;
            font-size: 0.9rem;
            line-height: 1.6;
        }

        .footer-links h3 {
            font-size: 1.2rem;
            margin-bottom: 1rem;
            color: var(--white);
        }

        .footer-links ul {
            list-style: none;
        }

        .footer-links ul li {
            margin-bottom: 0.8rem;
        }

        .footer-links ul li a {
            color: #bdc3c7;
            text-decoration: none;
            transition: var(--transition);
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .footer-links ul li a:hover {
            color: var(--secondary-color);
            transform: translateX(5px);
        }

        .footer-links ul li a i {
            font-size: 0.7rem;
        }

        .footer-contact h3 {
            font-size: 1.2rem;
            margin-bottom: 1rem;
            color: var(--white);
        }

        .footer-contact p {
            color: #bdc3c7;
            font-size: 0.9rem;
            margin-bottom: 1rem;
            display: flex;
            align-items: flex-start;
            gap: 0.5rem;
        }

        .footer-contact p i {
            margin-top: 0.2rem;
        }

        .social-icons {
            display: flex;
            gap: 1rem;
            margin-top: 1rem;
        }

        .social-icons a {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 35px;
            height: 35px;
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            color: var(--white);
            transition: var(--transition);
        }

        .social-icons a:hover {
            background-color: var(--secondary-color);
            color: var(--dark-color);
            transform: translateY(-3px);
        }

        .footer-bottom {
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            padding-top: 1.5rem;
            margin-top: 1.5rem;
        }

        .copyright {
            font-size: 0.9rem;
            color: #bdc3c7;
        }

        .payment-methods {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin-top: 1rem;
            flex-wrap: wrap;
        }

        .payment-methods img {
            height: 25px;
            width: auto;
            filter: grayscale(100%) brightness(2);
            transition: var(--transition);
        }

        .payment-methods img:hover {
            filter: none;
        }

        /* Back to Top Button */
        .back-to-top {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 50px;
            height: 50px;
            background-color: var(--primary-color);
            color: var(--white);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            cursor: pointer;
            transition: var(--transition);
            opacity: 0;
            visibility: hidden;
            z-index: 999;
            box-shadow: var(--shadow);
        }

        .back-to-top.active {
            opacity: 1;
            visibility: visible;
        }

        .back-to-top:hover {
            background-color: #004494;
            transform: translateY(-5px);
        }

        /* Responsive Styles */
        @media (max-width: 992px) {
            .hero-text h1 {
                font-size: 2.2rem;
            }

            .about-content {
                flex-direction: column;
            }

            .about-image {
                order: -1;
                margin-bottom: 2rem;
            }
        }

        @media (max-width: 768px) {
            .menu {
                position: fixed;
                top: 70px;
                left: -100%;
                width: 100%;
                height: calc(100vh - 70px);
                background-color: var(--dark-color);
                flex-direction: column;
                align-items: center;
                justify-content: flex-start;
                padding: 2rem 0;
                transition: var(--transition);
                z-index: 999;
            }

            .menu.active {
                left: 0;
            }

            .menu li {
                margin: 1rem 0;
            }

            .hamburger {
                display: block;
                color: var(--white);
            }

            .hero-text h1 {
                font-size: 2rem;
            }

            .hero-text p {
                font-size: 1rem;
            }

            .hero-buttons {
                flex-direction: column;
                align-items: center;
            }

            .hero-buttons .btn {
                width: 100%;
                max-width: 250px;
            }

            .container {
                flex-direction: column;
            }

            .left-section {
                padding: 2rem;
            }

            .right-section {
                padding: 2rem;
            }

            .column {
                flex-direction: column;
                gap: 1.2rem;
            }

            .form-row {
                flex-direction: column;
                gap: 1.2rem;
            }

            .footer-grid {
                grid-template-columns: 1fr;
                text-align: center;
            }

            .footer-links ul li a {
                justify-content: center;
            }

            .footer-contact p {
                justify-content: center;
            }

            .social-icons {
                justify-content: center;
            }
        }

        @media (max-width: 576px) {
            .hero-text {
                padding: 1.5rem;
            }

            .hero-text h1 {
                font-size: 1.8rem;
            }

            .modal-content, .feedback-content {
                padding: 1.5rem;
            }

            .confirmation-content {
                padding: 1.5rem;
            }

            .confirmation-buttons {
                flex-direction: column;
            }

            .confirmation-buttons button {
                width: 100%;
            }
        }
        /* Add these to your existing styles */

/* Dark mode */
body.dark-mode {
    background-color: #1a1a1a;
    color: #f0f0f0;
}

body.dark-mode .card,
body.dark-mode .category-card,
body.dark-mode .hired-card,
body.dark-mode .job-card,
body.dark-mode .testimonial-card,
body.dark-mode .contact-card,
body.dark-mode .contact-form,
body.dark-mode .modal-content,
body.dark-mode .confirmation-content,
body.dark-mode .feedback-content {
    background-color: #2d2d2d;
    color: #f0f0f0;
    border-color: #444;
}

body.dark-mode .input-box input,
body.dark-mode .input-box select,
body.dark-mode .input-box textarea,
body.dark-mode .form-group input,
body.dark-mode .form-group textarea {
    background-color: #333;
    color: #f0f0f0;
    border-color: #444;
}

body.dark-mode .section-title h2,
body.dark-mode .hired-container h2,
body.dark-mode .jobs-container h2,
body.dark-mode .contact-container h2,
body.dark-mode .about-container h2,
body.dark-mode .testimonials-container h2,
body.dark-mode .footer-links h3,
body.dark-mode .footer-contact h3,
body.dark-mode .card h2,
body.dark-mode .card h3,
body.dark-mode .hired-card h3,
body.dark-mode .job-card h3 {
    color: #f0f0f0;
}

body.dark-mode .stat-card,
body.dark-mode .left-section {
    background-color: rgba(0, 0, 0, 0.3);
}

/* Skeleton loading */
.skeleton-card {
    background-color: #e0e0e0;
    border-radius: 8px;
    height: 200px;
    animation: pulse 1.5s infinite ease-in-out;
}

body.dark-mode .skeleton-card {
    background-color: #333;
}

@keyframes pulse {
    0%, 100% { opacity: 0.6; }
    50% { opacity: 0.3; }
}

/* Animations */
@keyframes fadeInUp {
    from {
        opacity: 0;
        transform: translateY(20px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

/* Error messages */
.error-message {
    color: var(--danger-color);
    font-size: 0.8rem;
    margin-top: 0.25rem;
}

/* Map container */
#map {
    height: 300px;
    background-color: #eee;
    border-radius: 8px;
    margin-bottom: 1rem;
}

/* Responsive adjustments */
@media (max-width: 768px) {
    .search-input {
        width: 100%;
        margin: 0.5rem 0;
    }
    
    .dark-mode-toggle {
        margin-left: 0;
    }
}

/* Admin dashboard styles */
.admin-dashboard {
    display: none;
    padding: 2rem;
    background-color: var(--white);
}

.admin-dashboard h2 {
    margin-bottom: 1.5rem;
    color: var(--dark-color);
    border-bottom: 2px solid var(--secondary-color);
    padding-bottom: 0.5rem;
}

.dashboard-stats {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 1.5rem;
    margin-bottom: 2rem;
}

.stat-box {
    background-color: var(--light-color);
    padding: 1.5rem;
    border-radius: 8px;
    box-shadow: var(--shadow);
    text-align: center;
    transition: var(--transition);
}

.stat-box:hover {
    transform: translateY(-5px);
}

.stat-box i {
    font-size: 2rem;
    color: var(--primary-color);
    margin-bottom: 0.5rem;
}

.stat-box h3 {
    font-size: 1.8rem;
    margin-bottom: 0.5rem;
    color: var(--dark-color);
}

.stat-box p {
    color: var(--text-light);
    font-size: 0.9rem;
}

.dashboard-filters {
    display: flex;
    flex-wrap: wrap;
    gap: 1rem;
    margin-bottom: 1.5rem;
    padding: 1rem;
    background-color: var(--light-color);
    border-radius: 8px;
}

.filter-group {
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.filter-group label {
    font-weight: 500;
}

.filter-group select, 
.filter-group input {
    padding: 0.5rem;
    border: 1px solid #ddd;
    border-radius: 4px;
}

.admin-action-btn {
    background-color: var(--primary-color);
    color: var(--white);
    border: none;
    padding: 0.5rem 1rem;
    border-radius: 4px;
    cursor: pointer;
    transition: var(--transition);
}

.admin-action-btn:hover {
    background-color: #004494;
}

.status-badge {
    display: inline-block;
    padding: 0.25rem 0.5rem;
    border-radius: 20px;
    font-size: 0.8rem;
    font-weight: 500;
}

.status-active {
    background-color: rgba(40, 167, 69, 0.2);
    color: var(--success-color);
}

.status-pending {
    background-color: rgba(255, 193, 7, 0.2);
    color: var(--warning-color);
}

.status-rejected {
    background-color: rgba(220, 53, 69, 0.2);
    color: var(--danger-color);
}

.login-error {
    color: var(--danger-color);
    font-size: 0.9rem;
    margin-top: 0.5rem;
    text-align: center;
    display: none;
}

/* Admin badge in the header */
.admin-badge {
    display: none;
    background-color: var(--secondary-color);
    color: var(--dark-color);
    padding: 0.25rem 0.5rem;
    border-radius: 4px;
    font-size: 0.8rem;
    font-weight: 600;
    margin-left: 0.5rem;
}
    </style>
</head>

<body>
    <!-- Navigation Bar -->
    <nav>
        <div class="navbar">
            <div class="logo">
                <a href="#">
                    <i class="fas fa-users-cog" style="font-size: 1.8rem;"></i>
                    Truley Workers
                </a>
            </div>
            <ul class="menu">
                <li><a href="#home"><i class="fas fa-home"></i> Home</a></li>
                <li><a href="#about"><i class="fas fa-info-circle"></i> About</a></li>
                <li><a href="#testimonials"><i class="fas fa-star"></i> Testimonials</a></li>
                <li><a href="#feedback" id="feedback-link"><i class="fas fa-comment-alt"></i> Feedback</a></li>
                <li><a href="#contact"><i class="fas fa-envelope"></i> Contact</a></li>
                <li><a href="#hired" id="hired-link"><i class="fas fa-users"></i> Hired Workers</a></li>
                <li><a href="#jobs" id="jobs-link"><i class="fas fa-briefcase"></i> Posted Jobs</a></li>
                <li id="admin-panel-link" style="display: none;"><a href="#admin"><i class="fas fa-user-shield"></i> Admin Panel <span class="admin-badge">Admin</span></a></li>
                <li id="login-link"><a href="#" id="login-btn"><i class="fas fa-sign-in-alt"></i> Login</a></li>
                <li id="logout-link" style="display: none;"><a href="#" id="logout-btn"><i class="fas fa-sign-out-alt"></i> Logout</a></li>
            </ul>
            <div class="hamburger">
                <i class="fas fa-bars"></i>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <div class="hero-image" id="home">
        <div class="hero-text">
            <h1>Find Trusted Professionals Across Sri Lanka</h1>
            <p>Connect with skilled workers in your area or post job opportunities with ease</p>
            <div class="hero-buttons">
                <button class="btn btn-primary" onclick="window.location.href='#category'">
                    <i class="fas fa-search"></i> Browse Workers
                </button>
                <button class="btn btn-secondary" id="post-job-btn">
                    <i class="fas fa-plus"></i> Post a Job
                </button>
            </div>
        </div>
    </div>

    <!-- Stats Section -->
    <div class="stats-section">
        <div class="stats-container">
            <h2>Why Choose Truley Workers?</h2>
            <div class="stats-grid">
                <div class="stat-card">
                    <i class="fas fa-users"></i>
                    <h3>10,000+</h3>
                    <p>Verified Professionals</p>
                </div>
                <div class="stat-card">
                    <i class="fas fa-map-marker-alt"></i>
                    <h3>25+</h3>
                    <p>Districts Covered</p>
                </div>
                <div class="stat-card">
                    <i class="fas fa-handshake"></i>
                    <h3>95%</h3>
                    <p>Satisfaction Rate</p>
                </div>
                <div class="stat-card">
                    <i class="fas fa-clock"></i>
                    <h3>24/7</h3>
                    <p>Support Available</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Carousel Section -->
    <div class="carousel-section" id="category">
        <div class="wrapper">
            <div class="section-title">
                <h2>Featured Professionals</h2>
            </div>
            <i id="left" class="fa-solid fas fa-angle-left"></i>
            <ul class="carousel">
                <li class="card">
                    <div class="img"><img src="https://images.pexels.com/photos/1121796/pexels-photo-1121796.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=2" alt="House Cleaner" draggable="false"></div>
                    <h2>House Cleaner</h2>
                    <span>Colombo, Sri Lanka</span>
                    <div class="rating">
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star-half-alt"></i>
                        <span>4.5 (120)</span>
                    </div>
                    <button class="btn btn-primary">View Profile</button>
                </li>
                <li class="card">
                    <div class="img"><img src="https://images.pexels.com/photos/5592493/pexels-photo-5592493.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=2" alt="Plumber" draggable="false"></div>
                    <h2>Plumber</h2>
                    <span>Kandy, Sri Lanka</span>
                    <div class="rating">
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="far fa-star"></i>
                        <span>4.0 (85)</span>
                    </div>
                    <button class="btn btn-primary">View Profile</button>
                </li>
                <li class="card">
                    <div class="img"><img src="https://images.pexels.com/photos/8961498/pexels-photo-8961498.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=2" alt="Electrician" draggable="false"></div>
                    <h2>Electrician</h2>
                    <span>Gampaha, Sri Lanka</span>
                    <div class="rating">
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <span>5.0 (200)</span>
                    </div>
                    <button class="btn btn-primary">View Profile</button>
                </li>
                <li class="card">
                    <div class="img"><img src="https://images.pexels.com/photos/4489794/pexels-photo-4489794.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=2" alt="Car Mechanic" draggable="false"></div>
                    <h2>Car Mechanic</h2>
                    <span>Negombo, Sri Lanka</span>
                    <div class="rating">
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star-half-alt"></i>
                        <span>4.7 (150)</span>
                    </div>
                    <button class="btn btn-primary">View Profile</button>
                </li>
                <li class="card">
                    <div class="img"><img src="https://images.pexels.com/photos/2422915/pexels-photo-2422915.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=2" alt="Gardener" draggable="false"></div>
                    <h2>Gardener</h2>
                    <span>Nuwara Eliya, Sri Lanka</span>
                    <div class="rating">
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="far fa-star"></i>
                        <span>4.0 (75)</span>
                    </div>
                    <button class="btn btn-primary">View Profile</button>
                </li>
                <li class="card">
                    <div class="img"><img src="https://images.pexels.com/photos/5691622/pexels-photo-5691622.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=2" alt="Painter" draggable="false"></div>
                    <h2>Painter</h2>
                    <span>Galle, Sri Lanka</span>
                    <div class="rating">
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star-half-alt"></i>
                        <span>4.5 (90)</span>
                    </div>
                    <button class="btn btn-primary">View Profile</button>
                </li>
            </ul>
            <i id="right" class="fa-solid fas fa-angle-right"></i>
        </div>
    </div>

    <!-- Popular Categories -->
    <div class="categories-section">
        <div class="wrapper">
            <div class="section-title">
                <h2>Popular Categories</h2>
            </div>
            <div class="categories-grid">
                <div class="category-card">
                    <i class="fas fa-broom"></i>
                    <h3>House Cleaning</h3>
                    <p>Professional cleaners for your home or office</p>
                </div>
                <div class="category-card">
                    <i class="fas fa-tools"></i>
                    <h3>Plumbing</h3>
                    <p>Expert plumbers for all your pipe and drainage needs</p>
                </div>
                <div class="category-card">
                    <i class="fas fa-bolt"></i>
                    <h3>Electrical</h3>
                    <p>Certified electricians for safe installations</p>
                </div>
                <div class="category-card">
                    <i class="fas fa-car"></i>
                    <h3>Auto Repair</h3>
                    <p>Skilled mechanics for all vehicle types</p>
                </div>
                <div class="category-card">
                    <i class="fas fa-leaf"></i>
                    <h3>Gardening</h3>
                    <p>Landscaping and garden maintenance experts</p>
                </div>
                <div class="category-card">
                    <i class="fas fa-paint-roller"></i>
                    <h3>Painting</h3>
                    <p>Interior and exterior painting services</p>
                </div>
                <div class="category-card">
                    <i class="fas fa-hammer"></i>
                    <h3>Carpentry</h3>
                    <p>Custom woodwork and furniture repair</p>
                </div>
                <div class="category-card">
                    <i class="fas fa-snowflake"></i>
                    <h3>AC Repair</h3>
                    <p>Specialists in air conditioning maintenance</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Worker Registration Form -->
    <div class="body">
        <div class="container">
            <!-- Left Section -->
            <div class="left-section">
                <h1>Join Our Professional Network</h1>
                <p>
                    Register as a service provider and start getting hired for your skills. 
                    Join thousands of professionals already earning through our platform.
                </p>
                <ul>
                    <li><i class="fas fa-check-circle"></i> Get access to premium job opportunities</li>
                    <li><i class="fas fa-check-circle"></i> Set your own rates and schedule</li>
                    <li><i class="fas fa-check-circle"></i> Build your reputation with client reviews</li>
                    <li><i class="fas fa-check-circle"></i> Secure payments with our protection system</li>
                    <li><i class="fas fa-check-circle"></i> 24/7 customer support</li>
                </ul>
            </div>
    
            <!-- Right Section -->
            <div class="right-section">
                <header>Worker Registration</header>
                <form id="registration-form" class="form">
                    <div class="input-box">
                        <label class="required">Full Name</label>
                        <input type="text" placeholder="Enter your full name" required id="full-name">
                    </div>
                    <div class="input-box">
                        <label class="required">Email Address</label>
                        <input type="email" placeholder="Enter your email address" required id="email">
                    </div>
                    <div class="column">
                        <div class="input-box">
                            <label class="required">Phone Number</label>
                            <input type="tel" placeholder="Enter your phone number" required id="phone">
                        </div>
                        <div class="input-box">
                            <label class="required">NIC Number</label>
                            <input type="text" placeholder="Enter your NIC number" required id="nic">
                        </div>
                    </div>
                    <div class="column">
                        <div class="input-box">
                            <label class="required">Birth Date</label>
                            <input type="date" placeholder="Enter your birth date" required id="birth-date">
                        </div>
                        <div class="input-box">
                            <label class="required">District</label>
                            <select id="district" required>
                                <option value="">Select your district</option>
                                <option value="Colombo">Colombo</option>
                                <option value="Gampaha">Gampaha</option>
                                <option value="Kalutara">Kalutara</option>
                                <option value="Kandy">Kandy</option>
                                <option value="Matale">Matale</option>
                                <option value="Nuwara Eliya">Nuwara Eliya</option>
                                <option value="Galle">Galle</option>
                                <option value="Matara">Matara</option>
                                <option value="Hambantota">Hambantota</option>
                                <option value="Jaffna">Jaffna</option>
                                <option value="Kilinochchi">Kilinochchi</option>
                                <option value="Mannar">Mannar</option>
                                <option value="Vavuniya">Vavuniya</option>
                                <option value="Mullaitivu">Mullaitivu</option>
                                <option value="Batticaloa">Batticaloa</option>
                                <option value="Ampara">Ampara</option>
                                <option value="Trincomalee">Trincomalee</option>
                                <option value="Kurunegala">Kurunegala</option>
                                <option value="Puttalam">Puttalam</option>
                                <option value="Anuradhapura">Anuradhapura</option>
                                <option value="Polonnaruwa">Polonnaruwa</option>
                                <option value="Badulla">Badulla</option>
                                <option value="Monaragala">Monaragala</option>
                                <option value="Ratnapura">Ratnapura</option>
                                <option value="Kegalle">Kegalle</option>
                            </select>
                        </div>
                    </div>
                    <div class="gender-box">
                        <label class="required">Gender</label>
                        <div class="gender-option">
                            <div class="gender">
                                <input type="radio" id="check-male" name="gender" checked value="male">
                                <label for="check-male">Male</label>
                            </div>
                            <div class="gender">
                                <input type="radio" id="check-female" name="gender" value="female">
                                <label for="check-female">Female</label>
                            </div>
                        </div>
                    </div>
                    <div class="worker-category">
                        <label class="required">Service Category</label>
                        <select id="worker-type" required>
                            <option value="">Select your service category</option>
                            <option value="House Cleaner">House Cleaner</option>
                            <option value="Plumber">Plumber</option>
                            <option value="Electrician">Electrician</option>
                            <option value="Car Mechanic">Car Mechanic</option>
                            <option value="Gardener">Gardener</option>
                            <option value="Painter">Painter</option>
                            <option value="Carpenter">Carpenter</option>
                            <option value="AC Technician">AC Technician</option>
                            <option value="Mason">Mason</option>
                            <option value="Welder">Welder</option>
                            <option value="Driver">Driver</option>
                            <option value="Cook">Cook</option>
                            <option value="Babysitter">Babysitter</option>
                            <option value="Elderly Care">Elderly Care</option>
                            <option value="Other">Other</option>
                        </select>
                    </div>
                    <div class="input-box">
                        <label class="required">Years of Experience</label>
                        <input type="number" placeholder="Enter years of experience" required id="experience" min="0">
                    </div>
                    <div class="input-box">
                        <label>Skills (comma separated)</label>
                        <input type="text" placeholder="e.g. plumbing, electrical wiring, carpentry" id="skills">
                    </div>
                    <div class="input-box">
                        <label>Hourly Rate (LKR)</label>
                        <input type="number" placeholder="Enter your hourly rate" id="hourly-rate" min="0">
                    </div>
                    <div class="input-box address">
                        <label class="required">Address</label>
                        <input type="text" placeholder="Enter street address" required id="street">
                        <input type="text" placeholder="Enter city" required id="city">
                        <div class="column">
                            <input type="text" placeholder="Enter postal code" required id="postal-code">
                        </div>
                    </div>
                    <div class="input-box">
                        <label>Profile Picture</label>
                        <input type="file" id="profile-pic" accept="image/*">
                    </div>
                    <div class="input-box">
                        <label>NIC Front Image</label>
                        <input type="file" id="nic-front" accept="image/*">
                    </div>
                    <div class="input-box">
                        <label>NIC Back Image</label>
                        <input type="file" id="nic-back" accept="image/*">
                    </div>
                    <div class="input-box">
                        <div class="gender">
                            <input type="checkbox" id="terms" required>
                            <label for="terms">I agree to the <a href="#" style="color: var(--primary-color);">Terms and Conditions</a></label>
                        </div>
                    </div>
                    <button type="submit">Register Now</button>
                </form>
            </div>
        </div>
    </div>

    <!-- Job Posting Form (Hidden by default) -->
    <div class="body" id="job-posting-form" style="display: none;">
        <div class="container">
            <!-- Left Section -->
            <div class="left-section">
                <h1>Find the Right Professional</h1>
                <p>
                    Post your job requirements and connect with qualified professionals in your area. 
                    Our platform makes it easy to find the perfect match for your needs.
                </p>
                <ul>
                    <li><i class="fas fa-check-circle"></i> Access to thousands of verified professionals</li>
                    <li><i class="fas fa-check-circle"></i> Competitive pricing and transparent quotes</li>
                    <li><i class="fas fa-check-circle"></i> Secure payment system with job completion guarantee</li>
                    <li><i class="fas fa-check-circle"></i> Customer reviews and ratings for each professional</li>
                    <li><i class="fas fa-check-circle"></i> 24/7 customer support</li>
                </ul>
            </div>
    
            <!-- Right Section -->
            <div class="right-section">
                <header>Post a Job</header>
                <form id="job-form" class="form">
                    <div class="input-box">
                        <label class="required">Job Title</label>
                        <input type="text" placeholder="e.g. Need a plumber for bathroom repair" required id="job-title">
                    </div>
                    <div class="column">
                        <div class="input-box">
                            <label class="required">Job Category</label>
                            <select id="job-category" required>
                                <option value="">Select job category</option>
                                <option value="House Cleaning">House Cleaning</option>
                                <option value="Plumbing">Plumbing</option>
                                <option value="Electrical">Electrical</option>
                                <option value="Car Repair">Car Repair</option>
                                <option value="Gardening">Gardening</option>
                                <option value="Painting">Painting</option>
                                <option value="Carpentry">Carpentry</option>
                                <option value="AC Repair">AC Repair</option>
                                <option value="Masonry">Masonry</option>
                                <option value="Welding">Welding</option>
                                <option value="Driving">Driving</option>
                                <option value="Cooking">Cooking</option>
                                <option value="Child Care">Child Care</option>
                                <option value="Elderly Care">Elderly Care</option>
                                <option value="Other">Other</option>
                            </select>
                        </div>
                        <div class="input-box">
                            <label class="required">Job Type</label>
                            <select id="job-type" required>
                                <option value="">Select job type</option>
                                <option value="One-time">One-time</option>
                                <option value="Part-time">Part-time</option>
                                <option value="Full-time">Full-time</option>
                                <option value="Contract">Contract</option>
                            </select>
                        </div>
                    </div>
                    <div class="input-box">
                        <label class="required">Job Description</label>
                        <textarea placeholder="Describe the job in detail" required id="job-description" rows="4"></textarea>
                    </div>
                    <div class="column">
                        <div class="input-box">
                            <label class="required">District</label>
                            <select id="job-district" required>
                                <option value="">Select district</option>
                                <option value="Colombo">Colombo</option>
                                <option value="Gampaha">Gampaha</option>
                                <option value="Kalutara">Kalutara</option>
                                <option value="Kandy">Kandy</option>
                                <option value="Matale">Matale</option>
                                <option value="Nuwara Eliya">Nuwara Eliya</option>
                                <option value="Galle">Galle</option>
                                <option value="Matara">Matara</option>
                                <option value="Hambantota">Hambantota</option>
                                <option value="Jaffna">Jaffna</option>
                                <option value="Kilinochchi">Kilinochchi</option>
                                <option value="Mannar">Mannar</option>
                                <option value="Vavuniya">Vavuniya</option>
                                <option value="Mullaitivu">Mullaitivu</option>
                                <option value="Batticaloa">Batticaloa</option>
                                <option value="Ampara">Ampara</option>
                                <option value="Trincomalee">Trincomalee</option>
                                <option value="Kurunegala">Kurunegala</option>
                                <option value="Puttalam">Puttalam</option>
                                <option value="Anuradhapura">Anuradhapura</option>
                                <option value="Polonnaruwa">Polonnaruwa</option>
                                <option value="Badulla">Badulla</option>
                                <option value="Monaragala">Monaragala</option>
                                <option value="Ratnapura">Ratnapura</option>
                                <option value="Kegalle">Kegalle</option>
                            </select>
                        </div>
                        <div class="input-box">
                            <label class="required">City</label>
                            <input type="text" placeholder="Enter city" required id="job-city">
                        </div>
                    </div>
                    <div class="column">
                        <div class="input-box">
                            <label class="required">Budget (LKR)</label>
                            <input type="number" placeholder="Enter your budget" required id="budget" min="0">
                        </div>
                        <div class="input-box">
                            <label class="required">Urgency</label>
                            <select id="urgency" required>
                                <option value="">Select urgency</option>
                                <option value="Immediate">Immediate (within 24 hours)</option>
                                <option value="Urgent">Urgent (within 3 days)</option>
                                <option value="Flexible">Flexible (within a week)</option>
                                <option value="No Rush">No Rush (when available)</option>
                            </select>
                        </div>
                    </div>
                    <div class="column">
                        <div class="input-box">
                            <label class="required">Start Date</label>
                            <input type="date" required id="start-date">
                        </div>
                        <div class="input-box">
                            <label>End Date (if applicable)</label>
                            <input type="date" id="end-date">
                        </div>
                    </div>
                    <div class="input-box">
                        <label class="required">Your Name</label>
                        <input type="text" placeholder="Enter your name" required id="client-name">
                    </div>
                    <div class="column">
                        <div class="input-box">
                            <label class="required">Email Address</label>
                            <input type="email" placeholder="Enter your email" required id="client-email">
                        </div>
                        <div class="input-box">
                            <label class="required">Phone Number</label>
                            <input type="tel" placeholder="Enter your phone number" required id="client-phone">
                        </div>
                    </div>
                    <div class="input-box">
                        <label>Address (where work will be done)</label>
                        <textarea placeholder="Enter full address" id="job-address" rows="2"></textarea>
                    </div>
                    <div class="input-box">
                        <div class="gender">
                            <input type="checkbox" id="job-terms" required>
                            <label for="job-terms">I agree to the <a href="#" style="color: var(--primary-color);">Terms and Conditions</a></label>
                        </div>
                    </div>
                    <button type="submit">Post Job</button>
                </form>
            </div>
        </div>
    </div>

    <!-- Admin Dashboard Section -->
    <div class="admin-dashboard" id="admin-dashboard">
        <h2>Admin Dashboard</h2>
        <div class="dashboard-stats">
            <div class="stat-box">
                <i class="fas fa-users"></i>
                <h3 id="total-workers">0</h3>
                <p>Registered Workers</p>
            </div>
            <div class="stat-box">
                <i class="fas fa-briefcase"></i>
                <h3 id="total-jobs">0</h3>
                <p>Posted Jobs</p>
            </div>
            <div class="stat-box">
                <i class="fas fa-check-circle"></i>
                <h3 id="active-workers">0</h3>
                <p>Active Workers</p>
            </div>
            <div class="stat-box">
                <i class="fas fa-clock"></i>
                <h3 id="pending-approvals">0</h3>
                <p>Pending Approvals</p>
            </div>
        </div>
        <div class="dashboard-filters">
            <div class="filter-group">
                <label for="filter-status">Status:</label>
                <select id="filter-status">
                    <option value="all">All</option>
                    <option value="active">Active</option>
                    <option value="pending">Pending</option>
                    <option value="rejected">Rejected</option>
                </select>
            </div>
            <div class="filter-group">
                <label for="filter-category">Category:</label>
                <select id="filter-category">
                    <option value="all">All Categories</option>
                    <option value="House Cleaning">House Cleaning</option>
                    <option value="Plumbing">Plumbing</option>
                    <option value="Electrical">Electrical</option>
                    <option value="Car Repair">Car Repair</option>
                    <option value="Other">Other</option>
                </select>
            </div>
            <div class="filter-group">
                <label for="filter-search">Search:</label>
                <input type="text" id="filter-search" placeholder="Search by name">
            </div>
            <button class="admin-action-btn" id="apply-filters">Apply Filters</button>
            <button class="admin-action-btn" id="export-data">Export Data</button>
        </div>
        <div class="tabs">
            <button class="admin-action-btn active" data-tab="workers-tab">Workers</button>
            <button class="admin-action-btn" data-tab="jobs-tab">Jobs</button>
        </div>
        <div id="workers-tab" class="tab-content">
            <div class="hired-list" id="admin-workers-list">
                <!-- Workers will be loaded here -->
            </div>
        </div>
        <div id="jobs-tab" class="tab-content" style="display: none;">
            <div class="jobs-list" id="admin-jobs-list">
                <!-- Jobs will be loaded here -->
            </div>
        </div>
    </div>

    <!-- About Section -->
    <div class="about-section" id="about">
        <div class="about-container">
            <h2>About Truley Workers</h2>
            <div class="about-content">
                <div class="about-text">
                    <p>Truley Workers is Sri Lanka's premier platform connecting skilled professionals with clients who need their services. Founded in 2023, our mission is to bridge the gap between service providers and customers while ensuring quality, reliability, and trust.</p>
                    <p>We understand the challenges of finding trustworthy professionals for your home or business needs. Similarly, we recognize the difficulties skilled workers face in finding consistent work opportunities. Truley Workers was created to solve both these problems.</p>
                    <p>Our platform serves all major cities and towns across Sri Lanka, including Colombo, Kandy, Galle, Jaffna, and many more. Whether you're looking for a plumber in Negombo, an electrician in Gampaha, or a cleaner in Colombo, we've got you covered.</p>
                    <p>What sets us apart is our rigorous verification process for all professionals, customer reviews and ratings system, secure payment options, and dedicated customer support available in Sinhala, Tamil, and English.</p>
                </div>
                <div class="about-image">
                    <img src="https://images.pexels.com/photos/3184465/pexels-photo-3184465.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=2" alt="About Truley Workers">
                </div>
            </div>
        </div>
    </div>

    <!-- Testimonials Section -->
    <div class="testimonials-section" id="testimonials">
        <div class="testimonials-container">
            <h2>What Our Clients Say</h2>
            <div class="testimonials-grid">
                <div class="testimonial-card">
                    <div class="testimonial-header">
                        <div class="testimonial-avatar">
                            <img src="https://images.pexels.com/photos/220453/pexels-photo-220453.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=2" alt="Ramesh Perera">
                        </div>
                        <div class="testimonial-info">
                            <h4>Ramesh Perera</h4>
                            <p>Colombo</p>
                        </div>
                    </div>
                    <div class="testimonial-rating">
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                    </div>
                    <div class="testimonial-text">
                        "Found an excellent electrician through Truley Workers who fixed all the wiring issues in my home. Professional, punctual, and reasonably priced. Will definitely use the service again!"
                    </div>
                </div>
                <div class="testimonial-card">
                    <div class="testimonial-header">
                        <div class="testimonial-avatar">
                            <img src="https://images.pexels.com/photos/774909/pexels-photo-774909.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=2" alt="Nimali Fernando">
                        </div>
                        <div class="testimonial-info">
                            <h4>Nimali Fernando</h4>
                            <p>Kandy</p>
                        </div>
                    </div>
                    <div class="testimonial-rating">
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                    </div>
                    <div class="testimonial-text">
                        "As a working mother, finding reliable domestic help was always a challenge. Truley Workers connected me with a wonderful cleaner who comes twice a week. The verification process gave me peace of mind."
                    </div>
                </div>
                <div class="testimonial-card">
                    <div class="testimonial-header">
                        <div class="testimonial-avatar">
                            <img src="https://images.pexels.com/photos/2379004/pexels-photo-2379004.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=2" alt="Suresh Kumar">
                        </div>
                        <div class="testimonial-info">
                            <h4>Suresh Kumar</h4>
                            <p>Jaffna</p>
                        </div>
                    </div>
                    <div class="testimonial-rating">
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star-half-alt"></i>
                    </div>
                    <div class="testimonial-text">
                        "The plumber I hired through this platform did an excellent job fixing my bathroom leaks. The best part was being able to see his previous work and customer reviews before hiring."
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Hired Workers Section -->
    <div class="hired-section" id="hired">
        <div class="hired-container">
            <h2>Hired Workers</h2>
            <div class="hired-list" id="hired-workers">
                <!-- Workers will be added here dynamically -->
            </div>
        </div>
    </div>

    <!-- Posted Jobs Section -->
    <div class="jobs-section" id="jobs">
        <div class="jobs-container">
            <h2>Posted Jobs</h2>
            <div class="jobs-list" id="posted-jobs">
                <!-- Jobs will be added here dynamically -->
            </div>
        </div>
    </div>

    <!-- Contact Section -->
    <div class="contact-section" id="contact">
        <div class="contact-container">
            <h2>Contact Us</h2>
            <div class="contact-info">
                <div class="contact-card">
                    <i class="fas fa-map-marker-alt"></i>
                    <h3>Head Office</h3>
                    <p>123 Worker Street, Colombo 05, Sri Lanka</p>
                </div>
                <div class="contact-card">
                    <i class="fas fa-phone"></i>
                    <h3>Phone</h3>
                    <p>+94 11 234 5678</p>
                    <p>+94 76 123 4567 (Hotline)</p>
                </div>
                <div class="contact-card">
                    <i class="fas fa-envelope"></i>
                    <h3>Email</h3>
                    <p>info@truelyworkers.lk</p>
                    <p>support@truelyworkers.lk</p>
                </div>
                <div class="contact-card">
                    <i class="fas fa-clock"></i>
                    <h3>Working Hours</h3>
                    <p>Monday - Friday: 8:30 AM - 5:30 PM</p>
                    <p>Saturday: 9:00 AM - 1:00 PM</p>
                </div>
            </div>
            <div class="contact-form">
                <h3>Send Us a Message</h3>
                <form id="contact-form">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="contact-name">Your Name</label>
                            <input type="text" id="contact-name" placeholder="Enter your name" required>
                        </div>
                        <div class="form-group">
                            <label for="contact-email">Email Address</label>
                            <input type="email" id="contact-email" placeholder="Enter your email" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="contact-phone">Phone Number</label>
                            <input type="tel" id="contact-phone" placeholder="Enter your phone number">
                        </div>
                        <div class="form-group">
                            <label for="contact-subject">Subject</label>
                            <input type="text" id="contact-subject" placeholder="Enter subject" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="contact-message">Message</label>
                        <textarea id="contact-message" placeholder="Enter your message" rows="5" required></textarea>
                    </div>
                    <button type="submit" class="submit-btn">Send Message</button>
                </form>
            </div>
        </div>
    </div>

    <!-- Login Modal -->
    <div id="loginModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Admin Login</h2>
                <span class="close">&times;</span>
            </div>
            <form class="login-form" id="admin-login-form">
                <div class="form-group">
                    <label for="username">Username</label>
                    <input type="text" id="username" placeholder="Enter username" required>
                </div>
                <div class="form-group">
                    <label for="password">Password</label>
                    <input type="password" id="password" placeholder="Enter password" required>
                </div>
                <div class="remember-forgot">
                    <div class="remember-me">
                        <input type="checkbox" id="remember">
                        <label for="remember">Remember me</label>
                    </div>
                    <div class="forgot-password">
                        <a href="#">Forgot password?</a>
                    </div>
                </div>
                <div class="login-error" id="login-error">Invalid username or password. Please try again.</div>
                <button type="submit" id="login-button">Login</button>
                <div class="register-link">
                    Don't have an account? <a href="#">Register here</a>
                </div>
            </form>
        </div>
    </div>

    <!-- Confirmation Modal -->
    <div id="confirmationModal" class="confirmation-modal">
        <div class="confirmation-content">
            <h3>Confirm Action</h3>
            <p>Are you sure you want to perform this action? This cannot be undone.</p>
            <div class="confirmation-buttons">
                <button class="confirm-btn" id="confirmDelete">Confirm</button>
                <button class="cancel-btn" id="cancelDelete">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Feedback Modal -->
    <div id="feedbackModal" class="feedback-modal">
        <div class="feedback-content">
            <div class="feedback-header">
                <h2>Send Feedback</h2>
                <span class="close-feedback">&times;</span>
            </div>
            <form class="feedback-form" id="feedback-form">
                <div class="input-box">
                    <label for="feedback-name">Your Name</label>
                    <input type="text" id="feedback-name" placeholder="Enter your name" required>
                </div>
                <div class="input-box">
                    <label for="feedback-email">Your Email</label>
                    <input type="email" id="feedback-email" placeholder="Enter your email" required>
                </div>
                <div class="input-box">
                    <label for="feedback-subject">Subject</label>
                    <input type="text" id="feedback-subject" placeholder="Enter subject" required>
                </div>
                <div class="input-box">
                    <label for="feedback-message">Message</label>
                    <textarea id="feedback-message" placeholder="Enter your feedback message" rows="5" required></textarea>
                </div>
                <button type="submit">Send Feedback</button>
            </form>
        </div>
    </div>

    <!-- Success Message -->
    <div class="success-message" id="successMessage">
        Operation completed successfully!
    </div>

    <!-- Back to Top Button -->
    <div class="back-to-top" id="backToTop">
        <i class="fas fa-arrow-up"></i>
    </div>

    <!-- Footer -->
    <footer>
        <div class="footer-content">
            <div class="footer-grid">
                <div class="footer-logo">
                    <a href="#">
                        <i class="fas fa-users-cog" style="font-size: 1.8rem;"></i>
                        Truley Workers
                    </a>
                    <p>Sri Lanka's trusted platform connecting skilled professionals with clients. Quality service guaranteed.</p>
                    <div class="social-icons">
                        <a href="#"><i class="fab fa-facebook-f"></i></a>
                        <a href="#"><i class="fab fa-twitter"></i></a>
                        <a href="#"><i class="fab fa-instagram"></i></a>
                        <a href="#"><i class="fab fa-linkedin-in"></i></a>
                        <a href="#"><i class="fab fa-youtube"></i></a>
                    </div>
                </div>
                <div class="footer-links">
                    <h3>Quick Links</h3>
                    <ul>
                        <li><a href="#home"><i class="fas fa-chevron-right"></i> Home</a></li>
                        <li><a href="#about"><i class="fas fa-chevron-right"></i> About Us</a></li>
                        <li><a href="#testimonials"><i class="fas fa-chevron-right"></i> Testimonials</a></li>
                        <li><a href="#contact"><i class="fas fa-chevron-right"></i> Contact</a></li>
                        <li><a href="#" id="footer-feedback-link"><i class="fas fa-chevron-right"></i> Feedback</a></li>
                    </ul>
                </div>
                <div class="footer-links">
                    <h3>Services</h3>
                    <ul>
                        <li><a href="#"><i class="fas fa-chevron-right"></i> House Cleaning</a></li>
                        <li><a href="#"><i class="fas fa-chevron-right"></i> Plumbing</a></li>
                        <li><a href="#"><i class="fas fa-chevron-right"></i> Electrical</a></li>
                        <li><a href="#"><i class="fas fa-chevron-right"></i> Car Repair</a></li>
                        <li><a href="#"><i class="fas fa-chevron-right"></i> Gardening</a></li>
                    </ul>
                </div>
                <div class="footer-contact">
                    <h3>Contact Info</h3>
                    <p><i class="fas fa-map-marker-alt"></i> 123 Worker Street, Colombo 05, Sri Lanka</p>
                    <p><i class="fas fa-phone"></i> +94 11 234 5678</p>
                    <p><i class="fas fa-envelope"></i> info@truelyworkers.lk</p>
                    <div class="payment-methods">
                        <img src="https://via.placeholder.com/40x25" alt="Visa">
                        <img src="https://via.placeholder.com/40x25" alt="Mastercard">
                        <img src="https://via.placeholder.com/40x25" alt="PayPal">
                        <img src="https://via.placeholder.com/40x25" alt="Dialog">
                        <img src="https://via.placeholder.com/40x25" alt="mCash">
                    </div>
                </div>
            </div>
            <div class="footer-bottom">
                <div class="copyright">
                    &copy; 2023 Truley Workers. All Rights Reserved. | <a href="#">Privacy Policy</a> | <a href="#">Terms of Service</a>
                </div>
            </div>
        </div>
    </footer>

    <script>
document.addEventListener("DOMContentLoaded", function () {
    // Database setup
    const dbPromise = setupDatabase();
    
    // Service Worker Registration
    if ('serviceWorker' in navigator) {
        navigator.serviceWorker.register('/sw.js')
            .then(registration => console.log('SW registered'))
            .catch(err => console.log('SW registration failed: ', err));
    }

    // Mobile Menu Toggle with animation
    const hamburger = document.querySelector('.hamburger');
    const menu = document.querySelector('.menu');

    hamburger.addEventListener('click', function() {
        menu.classList.toggle('active');
        hamburger.innerHTML = menu.classList.contains('active') ? 
            '<i class="fas fa-times"></i>' : '<i class="fas fa-bars"></i>';
        
        // Animate menu items
        if (menu.classList.contains('active')) {
            const items = menu.querySelectorAll('li');
            items.forEach((item, index) => {
                item.style.animation = `fadeInUp 0.3s ease forwards ${index * 0.1}s`;
            });
        }
    });

    // Carousel with auto-play and touch support
    const carousel = document.querySelector(".carousel");
    const arrowBtns = document.querySelectorAll(".wrapper i");
    const wrapper = document.querySelector(".wrapper");

    // Initialize carousel
    initCarousel();

    // Back to top button with smooth scroll
    const backToTopBtn = document.getElementById('backToTop');
    initBackToTop();

    // Form submissions with validation
    initForms();

    // Modal and dialog functionality
    initModals();

    // Page navigation and section management
    initNavigation();

    // Search functionality
    initSearch();

    // Location services
    initLocationServices();

    // Dark mode toggle
    initDarkMode();

    // Admin dashboard functionality
    initAdminDashboard();

    // Authentication
    let currentUser = null;
    
    // Initialize all components
    async function setupDatabase() {
        return new Promise((resolve, reject) => {
            const request = indexedDB.open('TruleyWorkersDB', 2);
            
            request.onupgradeneeded = (event) => {
                const db = event.target.result;
                
                if (!db.objectStoreNames.contains('workers')) {
                    const workersStore = db.createObjectStore('workers', { keyPath: 'id', autoIncrement: true });
                    workersStore.createIndex('workerType', 'workerType', { unique: false });
                    workersStore.createIndex('district', 'district', { unique: false });
                }
                
                if (!db.objectStoreNames.contains('jobs')) {
                    const jobsStore = db.createObjectStore('jobs', { keyPath: 'id', autoIncrement: true });
                    jobsStore.createIndex('jobCategory', 'jobCategory', { unique: false });
                    jobsStore.createIndex('jobDistrict', 'jobDistrict', { unique: false });
                }
                
                if (!db.objectStoreNames.contains('users')) {
                    const usersStore = db.createObjectStore('users', { keyPath: 'id', autoIncrement: true });
                    usersStore.createIndex('username', 'username', { unique: true });
                    
                    // Add admin user
                    usersStore.add({
                        id: 1,
                        username: 'admin2025',
                        password: '12345678',
                        role: 'admin',
                        email: 'admin@truelyworkers.lk',
                        lastLogin: null
                    });
                }
            };
            
            request.onsuccess = (event) => {
                resolve(event.target.result);
                // Load initial data
                loadInitialData(event.target.result);
            };
            
            request.onerror = (event) => {
                console.error('Database error:', event.target.error);
                reject(event.target.error);
            };
        });
    }

    function loadInitialData(db) {
        // Check if data exists, if not, load sample data
        const transaction = db.transaction(['workers', 'jobs', 'users'], 'readonly');
        const workersStore = transaction.objectStore('workers');
        const jobsStore = transaction.objectStore('jobs');
        const usersStore = transaction.objectStore('users');
        
        workersStore.count().onsuccess = (event) => {
            if (event.target.result === 0) {
                loadSampleWorkers(db);
            }
        };
        
        jobsStore.count().onsuccess = (event) => {
            if (event.target.result === 0) {
                loadSampleJobs(db);
            }
        };
        
        usersStore.count().onsuccess = (event) => {
            if (event.target.result === 0) {
                // Ensure admin user exists
                const userTransaction = db.transaction(['users'], 'readwrite');
                const userStore = userTransaction.objectStore('users');
                
                userStore.add({
                    id: 1,
                    username: 'admin2025',
                    password: '12345678',
                    role: 'admin',
                    email: 'admin@truelyworkers.lk',
                    lastLogin: null
                });
            }
        };
    }

    function loadSampleWorkers(db) {
        const sampleWorkers = [
            {
                fullName: "Kamal Perera",
                email: "kamal@example.com",
                phone: "0771234567",
                nic: "123456789V",
                birthDate: "1985-05-15",
                gender: "male",
                district: "Colombo",
                workerType: "Electrician",
                experience: 10,
                skills: "Wiring, Circuit repair, Panel installation",
                hourlyRate: 1500,
                street: "12 Main Street",
                city: "Colombo 05",
                postalCode: "00500",
                registrationDate: new Date().toISOString(),
                rating: 4.5,
                completedJobs: 42,
                status: "active"
            },
            {
                fullName: "Anura Silva",
                email: "anura@example.com",
                phone: "0763456789",
                nic: "789456123V",
                birthDate: "1990-08-22",
                gender: "male",
                district: "Gampaha",
                workerType: "Plumber",
                experience: 8,
                skills: "Pipe fitting, Leak repair, Installation",
                hourlyRate: 1300,
                street: "45 Lake Road",
                city: "Ja-Ela",
                postalCode: "11350",
                registrationDate: new Date().toISOString(),
                rating: 4.8,
                completedJobs: 56,
                status: "active"
            },
            {
                fullName: "Kumari Jayawardena",
                email: "kumari@example.com",
                phone: "0712345678",
                nic: "957841236V",
                birthDate: "1995-03-10",
                gender: "female",
                district: "Kandy",
                workerType: "House Cleaner",
                experience: 5,
                skills: "Deep cleaning, Organizing, Window cleaning",
                hourlyRate: 1000,
                street: "78 Hill Street",
                city: "Kandy",
                postalCode: "20000",
                registrationDate: new Date().toISOString(),
                rating: 4.7,
                completedJobs: 35,
                status: "active"
            }
        ];
        
        const transaction = db.transaction(['workers'], 'readwrite');
        const store = transaction.objectStore('workers');
        
        sampleWorkers.forEach(worker => {
            store.add(worker);
        });
    }

    function loadSampleJobs(db) {
        const sampleJobs = [
            {
                jobTitle: "Bathroom plumbing repair",
                jobCategory: "Plumbing",
                jobType: "One-time",
                jobDescription: "Need to fix leaking pipes in master bathroom",
                jobDistrict: "Colombo",
                jobCity: "Colombo 03",
                jobAddress: "34 Flower Road, Colombo 03",
                budget: 5000,
                urgency: "Urgent",
                startDate: new Date(Date.now() + 86400000).toISOString().split('T')[0],
                clientName: "Nimali Fernando",
                clientEmail: "nimali@example.com",
                clientPhone: "0712345678",
                postedDate: new Date().toISOString(),
                status: "open"
            },
            {
                jobTitle: "House cleaning service needed",
                jobCategory: "House Cleaning",
                jobType: "Part-time",
                jobDescription: "Looking for weekly house cleaning service, 3 bedroom house",
                jobDistrict: "Gampaha",
                jobCity: "Negombo",
                jobAddress: "12 Beach Road, Negombo",
                budget: 3000,
                urgency: "Flexible",
                startDate: new Date(Date.now() + 172800000).toISOString().split('T')[0],
                clientName: "Ravi Perera",
                clientEmail: "ravi@example.com",
                clientPhone: "0765432198",
                postedDate: new Date().toISOString(),
                status: "open"
            },
            {
                jobTitle: "Need an electrician for home wiring",
                jobCategory: "Electrical",
                jobType: "One-time",
                jobDescription: "Need to rewire the living room and install new light fixtures",
                jobDistrict: "Kandy",
                jobCity: "Kandy",
                jobAddress: "56 Hill Street, Kandy",
                budget: 7500,
                urgency: "Immediate",
                startDate: new Date().toISOString().split('T')[0],
                clientName: "Pradeep Kumar",
                clientEmail: "pradeep@example.com",
                clientPhone: "0778901234",
                postedDate: new Date().toISOString(),
                status: "open"
            }
        ];
        
        const transaction = db.transaction(['jobs'], 'readwrite');
        const store = transaction.objectStore('jobs');
        
        sampleJobs.forEach(job => {
            store.add(job);
        });
    }

    function initCarousel() {
        const firstCard = carousel.querySelector(".card");
        if (!firstCard) return;
        
        const firstCardWidth = firstCard.offsetWidth + 20;
        let isDragging = false, startX, startScrollLeft, timeoutId;

        // Touch event handlers
        carousel.addEventListener("touchstart", dragStart);
        carousel.addEventListener("touchmove", dragging);
        carousel.addEventListener("touchend", dragStop);

        // Mouse event handlers
        carousel.addEventListener("mousedown", dragStart);
        carousel.addEventListener("mousemove", dragging);
        document.addEventListener("mouseup", dragStop);

        // Auto-play
        wrapper.addEventListener("mouseenter", () => clearTimeout(timeoutId));
        wrapper.addEventListener("mouseleave", autoPlay);
        
        // Arrow buttons
        arrowBtns.forEach(btn => {
            btn.addEventListener("click", () => {
                carousel.scrollLeft += btn.id === "left" ? -firstCardWidth : firstCardWidth;
                resetAutoPlay();
            });
        });

        function dragStart(e) {
            isDragging = true;
            carousel.classList.add("dragging");
            startX = e.pageX || e.touches[0].pageX;
            startScrollLeft = carousel.scrollLeft;
        }

        function dragging(e) {
            if (!isDragging) return;
            const x = e.pageX || e.touches[0].pageX;
            carousel.scrollLeft = startScrollLeft - (x - startX);
        }

        function dragStop() {
            isDragging = false;
            carousel.classList.remove("dragging");
            resetAutoPlay();
        }

        function autoPlay() {
            if (window.innerWidth < 800) return;
            const totalCardWidth = carousel.scrollWidth;
            const maxScrollLeft = totalCardWidth - carousel.offsetWidth;
            
            if (carousel.scrollLeft >= maxScrollLeft - 10) {
                carousel.scrollLeft = 0;
            } else {
                carousel.scrollLeft += firstCardWidth;
            }
            
            timeoutId = setTimeout(autoPlay, 3000);
        }

        function resetAutoPlay() {
            clearTimeout(timeoutId);
            timeoutId = setTimeout(autoPlay, 3000);
        }

        // Initialize autoplay
        timeoutId = setTimeout(autoPlay, 3000);
    }

    function initBackToTop() {
        window.addEventListener('scroll', function() {
            backToTopBtn.classList.toggle('active', window.pageYOffset > 300);
        });

        backToTopBtn.addEventListener('click', function() {
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        });
    }

    function initForms() {
        // Worker registration form with enhanced validation
        const registrationForm = document.getElementById('registration-form');
        if (registrationForm) {
            registrationForm.addEventListener('submit', async function(e) {
                e.preventDefault();
                
                // Validate form
                if (!validateRegistrationForm()) return;
                
                // Show loading state
                const submitBtn = registrationForm.querySelector('button[type="submit"]');
                const originalBtnText = submitBtn.textContent;
                submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Registering...';
                submitBtn.disabled = true;
                
                try {
                    const db = await dbPromise;
                    const transaction = db.transaction(['workers'], 'readwrite');
                    const store = transaction.objectStore('workers');
                    
                    const worker = {
                        fullName: document.getElementById('full-name').value.trim(),
                        email: document.getElementById('email').value.trim(),
                        phone: document.getElementById('phone').value.trim(),
                        nic: document.getElementById('nic').value.trim(),
                        birthDate: document.getElementById('birth-date').value,
                        gender: document.querySelector('input[name="gender"]:checked').value,
                        district: document.getElementById('district').value,
                        workerType: document.getElementById('worker-type').value,
                        experience: parseInt(document.getElementById('experience').value),
                        skills: document.getElementById('skills').value.trim(),
                        hourlyRate: parseFloat(document.getElementById('hourly-rate').value) || null,
                        street: document.getElementById('street').value.trim(),
                        city: document.getElementById('city').value.trim(),
                        postalCode: document.getElementById('postal-code').value.trim(),
                        registrationDate: new Date().toISOString(),
                        rating: 0,
                        completedJobs: 0,
                        status: "active"
                    };
                    
                    // Handle file uploads (simulated)
                    const profilePic = document.getElementById('profile-pic').files[0];
                    if (profilePic) {
                        worker.profilePic = await readFileAsDataURL(profilePic);
                    }
                    
                    const nicFront = document.getElementById('nic-front').files[0];
                    if (nicFront) {
                        worker.nicFront = await readFileAsDataURL(nicFront);
                    }
                    
                    const nicBack = document.getElementById('nic-back').files[0];
                    if (nicBack) {
                        worker.nicBack = await readFileAsDataURL(nicBack);
                    }
                    
                    const request = store.add(worker);
                    
                    request.onsuccess = () => {
                        showSuccessMessage('Worker registered successfully!');
                        registrationForm.reset();
                        
                        // If user is logged in as admin, refresh the dashboard
                        if (currentUser && currentUser.role === 'admin') {
                            displayHiredWorkers();
                            updateDashboardStats();
                        }
                    };
                    
                    request.onerror = (event) => {
                        console.error('Error adding worker:', event.target.error);
                        showErrorMessage('Failed to register worker. Please try again.');
                    };
                } catch (error) {
                    console.error('Error:', error);
                    showErrorMessage('An error occurred. Please try again.');
                } finally {
                    submitBtn.textContent = originalBtnText;
                    submitBtn.disabled = false;
                }
            });
            
            // Add real-time validation
            addRealTimeValidation(registrationForm);
        }
        
        // Job posting form
        const jobForm = document.getElementById('job-form');
        if (jobForm) {
            jobForm.addEventListener('submit', async function(e) {
                e.preventDefault();
                
                // Validate form
                if (!validateJobForm()) return;
                
                // Show loading state
                const submitBtn = jobForm.querySelector('button[type="submit"]');
                const originalBtnText = submitBtn.textContent;
                submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Posting...';
                submitBtn.disabled = true;
                
                try {
                    const db = await dbPromise;
                    const transaction = db.transaction(['jobs'], 'readwrite');
                    const store = transaction.objectStore('jobs');
                    
                    const job = {
                        jobTitle: document.getElementById('job-title').value.trim(),
                        jobCategory: document.getElementById('job-category').value,
                        jobType: document.getElementById('job-type').value,
                        jobDescription: document.getElementById('job-description').value.trim(),
                        jobDistrict: document.getElementById('job-district').value,
                        jobCity: document.getElementById('job-city').value.trim(),
                        jobAddress: document.getElementById('job-address').value.trim(),
                        budget: parseFloat(document.getElementById('budget').value),
                        urgency: document.getElementById('urgency').value,
                        startDate: document.getElementById('start-date').value,
                        endDate: document.getElementById('end-date').value || null,
                        clientName: document.getElementById('client-name').value.trim(),
                        clientEmail: document.getElementById('client-email').value.trim(),
                        clientPhone: document.getElementById('client-phone').value.trim(),
                        postedDate: new Date().toISOString(),
                        status: "open"
                    };
                    
                    const request = store.add(job);
                    
                    request.onsuccess = () => {
                        showSuccessMessage('Job posted successfully!');
                        jobForm.reset();
                        
                        // If user is logged in as admin, refresh the dashboard
                        if (currentUser && currentUser.role === 'admin') {
                            displayPostedJobs();
                            updateDashboardStats();
                        }
                        
                        // In a real app, we would match this job with suitable workers
                        matchJobWithWorkers(job);
                    };
                    
                    request.onerror = (event) => {
                        console.error('Error adding job:', event.target.error);
                        showErrorMessage('Failed to post job. Please try again.');
                    };
                } catch (error) {
                    console.error('Error:', error);
                    showErrorMessage('An error occurred. Please try again.');
                } finally {
                    submitBtn.textContent = originalBtnText;
                    submitBtn.disabled = false;
                }
            });
            
            // Add real-time validation
            addRealTimeValidation(jobForm);
        }
        
        // Contact form
        const contactForm = document.getElementById('contact-form');
        if (contactForm) {
            contactForm.addEventListener('submit', function(e) {
                e.preventDefault();
                
                // Validate form
                if (!validateContactForm()) return;
                
                const contactData = {
                    name: document.getElementById('contact-name').value.trim(),
                    email: document.getElementById('contact-email').value.trim(),
                    phone: document.getElementById('contact-phone').value.trim(),
                    subject: document.getElementById('contact-subject').value.trim(),
                    message: document.getElementById('contact-message').value.trim(),
                    date: new Date().toISOString()
                };
                
                // Simulate sending to server
                setTimeout(() => {
                    showSuccessMessage('Your message has been sent successfully!');
                    contactForm.reset();
                    
                    // Close contact section if open
                    document.querySelector('.contact-section').style.display = 'none';
                    showSection('home');
                }, 1000);
            });
            
            // Add real-time validation
            addRealTimeValidation(contactForm);
        }
    }

    function validateRegistrationForm() {
        // Check required fields
        const requiredFields = [
            'full-name', 'email', 'phone', 'nic', 
            'birth-date', 'district', 'worker-type', 
            'experience', 'street', 'city', 'postal-code'
        ];
        
        let isValid = true;
        
        requiredFields.forEach(id => {
            const field = document.getElementById(id);
            if (!field.value.trim()) {
                markFieldAsInvalid(field);
                isValid = false;
            } else {
                markFieldAsValid(field);
            }
        });
        
        // Validate email format
        const email = document.getElementById('email');
        if (!isValidEmail(email.value.trim())) {
            markFieldAsInvalid(email, 'Please enter a valid email address');
            isValid = false;
        }
        
        // Validate phone number
        const phone = document.getElementById('phone');
        if (!isValidPhone(phone.value.trim())) {
            markFieldAsInvalid(phone, 'Please enter a valid phone number');
            isValid = false;
        }
        
        // Validate NIC format
        const nic = document.getElementById('nic');
        if (!isValidNIC(nic.value.trim())) {
            markFieldAsInvalid(nic, 'Please enter a valid NIC number');
            isValid = false;
        }
        
        // Validate age (must be at least 18)
        const birthDate = document.getElementById('birth-date');
        if (birthDate.value) {
            const dob = new Date(birthDate.value);
            const today = new Date();
            let age = today.getFullYear() - dob.getFullYear();
            const monthDiff = today.getMonth() - dob.getMonth();
            
            if (monthDiff < 0 || (monthDiff === 0 && today.getDate() < dob.getDate())) {
                age--;
            }
            
            if (age < 18) {
                markFieldAsInvalid(birthDate, 'You must be at least 18 years old');
                isValid = false;
            }
        }
        
        // Validate terms checkbox
        const terms = document.getElementById('terms');
        if (!terms.checked) {
            markFieldAsInvalid(terms, 'You must agree to the terms and conditions');
            isValid = false;
        }
        
        return isValid;
    }

    function validateJobForm() {
        // Similar validation logic for job form
        // ...
        return true;
    }

    function validateContactForm() {
        // Similar validation logic for contact form
        // ...
        return true;
    }

    function markFieldAsInvalid(field, message = 'This field is required') {
        field.style.borderColor = 'var(--danger-color)';
        
        let errorElement = field.nextElementSibling;
        if (!errorElement || !errorElement.classList.contains('error-message')) {
            errorElement = document.createElement('div');
            errorElement.className = 'error-message';
            errorElement.style.color = 'var(--danger-color)';
            errorElement.style.fontSize = '0.8rem';
            errorElement.style.marginTop = '0.25rem';
            field.parentNode.insertBefore(errorElement, field.nextSibling);
        }
        
        errorElement.textContent = message;
    }

    function markFieldAsValid(field) {
        field.style.borderColor = '#ddd';
        
        const errorElement = field.nextElementSibling;
        if (errorElement && errorElement.classList.contains('error-message')) {
            errorElement.textContent = '';
        }
    }

    function addRealTimeValidation(form) {
        const inputs = form.querySelectorAll('input, select, textarea');
        
        inputs.forEach(input => {
            input.addEventListener('input', function() {
                if (this.value.trim()) {
                    markFieldAsValid(this);
                }
            });
            
            // Special validation for certain fields
            if (input.id === 'email') {
                input.addEventListener('blur', function() {
                    if (this.value.trim() && !isValidEmail(this.value.trim())) {
                        markFieldAsInvalid(this, 'Please enter a valid email address');
                    }
                });
            }
            
            if (input.id === 'phone') {
                input.addEventListener('blur', function() {
                    if (this.value.trim() && !isValidPhone(this.value.trim())) {
                        markFieldAsInvalid(this, 'Please enter a valid phone number');
                    }
                });
            }
        });
    }

    function isValidEmail(email) {
        return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);
    }

    function isValidPhone(phone) {
        return /^[0-9]{10}$/.test(phone);
    }

    function isValidNIC(nic) {
        return /^[0-9]{9}[vVxX]?$/.test(nic) || /^[0-9]{12}$/.test(nic);
    }

    function readFileAsDataURL(file) {
        return new Promise((resolve, reject) => {
            const reader = new FileReader();
            reader.onload = () => resolve(reader.result);
            reader.onerror = reject;
            reader.readAsDataURL(file);
        });
    }

    function initModals() {
        // Login modal
        const loginModal = document.getElementById('loginModal');
        const closeBtn = document.querySelector('.close');
        const adminLoginForm = document.getElementById('admin-login-form');
        const loginBtn = document.getElementById('login-btn');
        const logoutBtn = document.getElementById('logout-btn');
        const loginError = document.getElementById('login-error');
        
        // Confirmation modal
        const confirmationModal = document.getElementById('confirmationModal');
        const confirmDeleteBtn = document.getElementById('confirmDelete');
        const cancelDeleteBtn = document.getElementById('cancelDelete');
        
        // Feedback modal
        const feedbackModal = document.getElementById('feedbackModal');
        const feedbackForm = document.getElementById('feedback-form');
        const closeFeedbackBtn = document.querySelector('.close-feedback');
        const feedbackLink = document.getElementById('feedback-link');
        const footerFeedbackLink = document.getElementById('footer-feedback-link');
        
        // Success message
        const successMessage = document.getElementById('successMessage');
        
        // Item to delete and delete type
        let itemToDelete = null;
        let deleteType = '';
        let currentSection = '';
        
        // Show login modal when login button is clicked
        loginBtn.addEventListener('click', function(e) {
            e.preventDefault();
            loginModal.style.display = 'block';
        });
        
        // Logout button click handler
        logoutBtn.addEventListener('click', function(e) {
            e.preventDefault();
            logout();
        });
        
        // Show feedback modal when feedback links are clicked
        feedbackLink.addEventListener('click', function(e) {
            e.preventDefault();
            feedbackModal.style.display = 'block';
        });
        
        footerFeedbackLink.addEventListener('click', function(e) {
            e.preventDefault();
            feedbackModal.style.display = 'block';
        });
        
        // Close modal when clicking X
        closeBtn.addEventListener('click', closeLoginModal);
        closeFeedbackBtn.addEventListener('click', () => feedbackModal.style.display = 'none');
        
        // Close modals when clicking outside
        window.addEventListener('click', function(event) {
            if (event.target === loginModal) closeLoginModal();
            if (event.target === confirmationModal) confirmationModal.style.display = 'none';
            if (event.target === feedbackModal) feedbackModal.style.display = 'none';
        });
        
        // Admin login form submission
        adminLoginForm.addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const username = document.getElementById('username').value.trim();
            const password = document.getElementById('password').value;
            const rememberMe = document.getElementById('remember').checked;
            
            // Hide any previous error message
            loginError.style.display = 'none';
            
            // Show loading state
            const submitBtn = adminLoginForm.querySelector('button[type="submit"]');
            const originalBtnText = submitBtn.textContent;
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Logging in...';
            submitBtn.disabled = true;
            
            // Check credentials directly
            if (username === 'admin2025' && password === '12345678') {
                // Create admin user object
                currentUser = {
                    id: 1,
                    username: 'admin2025',
                    role: 'admin',
                    lastLogin: new Date().toISOString()
                };
                
                // Store session
                if (rememberMe) {
                    localStorage.setItem('currentUser', JSON.stringify(currentUser));
                } else {
                    sessionStorage.setItem('currentUser', JSON.stringify(currentUser));
                }
                
                // Close modal
                closeLoginModal();
                showSuccessMessage('Login successful!');
                
                // Update UI for logged in admin
                updateUIForLoggedInAdmin();
                
                // Show the requested section or admin dashboard
                if (currentSection) {
                    showSection(currentSection);
                } else {
                    showSection('admin');
                }
            } else {
                // Show error message for invalid credentials
                loginError.style.display = 'block';
                submitBtn.textContent = originalBtnText;
                submitBtn.disabled = false;
            }
        });
        
        function closeLoginModal() {
            loginModal.style.display = 'none';
            document.getElementById('username').value = '';
            document.getElementById('password').value = '';
            document.getElementById('login-error').style.display = 'none';
        }
        
        // Confirmation modal actions
        confirmDeleteBtn.addEventListener('click', async function() {
            try {
                const db = await dbPromise;
                
                if (deleteType === 'worker') {
                    const transaction = db.transaction(['workers'], 'readwrite');
                    const store = transaction.objectStore('workers');
                    
                    const request = store.delete(itemToDelete);
                    
                    request.onsuccess = () => {
                        showSuccessMessage('Worker removed successfully!');
                        displayHiredWorkers();
                        updateDashboardStats();
                    };
                } else if (deleteType === 'job') {
                    const transaction = db.transaction(['jobs'], 'readwrite');
                    const store = transaction.objectStore('jobs');
                    
                    const request = store.delete(itemToDelete);
                    
                    request.onsuccess = () => {
                        showSuccessMessage('Job removed successfully!');
                        displayPostedJobs();
                        updateDashboardStats();
                    };
                }
            } catch (error) {
                console.error('Error:', error);
                showErrorMessage('Failed to delete. Please try again.');
            }
            
            confirmationModal.style.display = 'none';
        });
        
        cancelDeleteBtn.addEventListener('click', function() {
            confirmationModal.style.display = 'none';
        });
        
        // Feedback form submission
        feedbackForm.addEventListener('submit', function(e) {
            e.preventDefault();
            
            const name = document.getElementById('feedback-name').value.trim();
            const email = document.getElementById('feedback-email').value.trim();
            const subject = document.getElementById('feedback-subject').value.trim();
            const message = document.getElementById('feedback-message').value.trim();
            
            // Validate form
            if (!name || !email || !subject || !message) {
                showErrorMessage('Please fill all required fields');
                return;
            }
            
            if (!isValidEmail(email)) {
                showErrorMessage('Please enter a valid email address');
                return;
            }
            
            // Show loading state
            const submitBtn = feedbackForm.querySelector('button[type="submit"]');
            const originalBtnText = submitBtn.textContent;
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Sending...';
            submitBtn.disabled = true;
            
            // Simulate sending feedback
            setTimeout(() => {
                feedbackForm.reset();
                feedbackModal.style.display = 'none';
                showSuccessMessage('Thank you for your feedback!');
                
                submitBtn.textContent = originalBtnText;
                submitBtn.disabled = false;
            }, 1500);
        });
    }
    
    // Function to handle user logout
    function logout() {
        // Clear user data
        currentUser = null;
        localStorage.removeItem('currentUser');
        sessionStorage.removeItem('currentUser');
        
        // Update UI for logged out state
        document.getElementById('login-link').style.display = 'block';
        document.getElementById('logout-link').style.display = 'none';
        document.getElementById('admin-panel-link').style.display = 'none';
        
        // Hide admin dashboard if visible
        document.getElementById('admin-dashboard').style.display = 'none';
        
        // Show homepage
        showSection('home');
        
        showSuccessMessage('Logged out successfully');
    }
    
    // Function to update UI for logged in admin
    function updateUIForLoggedInAdmin() {
        document.getElementById('login-link').style.display = 'none';
        document.getElementById('logout-link').style.display = 'block';
        document.getElementById('admin-panel-link').style.display = 'block';
        
        // Load data for admin dashboard
        updateDashboardStats();
        displayHiredWorkers();
        displayPostedJobs();
        displayAdminWorkers();
        displayAdminJobs();
    }

    function initNavigation() {
        // Post Job button click handler
        const postJobBtn = document.getElementById('post-job-btn');
        const jobPostingForm = document.getElementById('job-posting-form');
        
        postJobBtn.addEventListener('click', function(e) {
            e.preventDefault();
            showSection('post-job');
        });
        
        // Hired link click handler (requires login)
        const hiredLink = document.getElementById('hired-link');
        const jobsLink = document.getElementById('jobs-link');
        const adminPanelLink = document.getElementById('admin-panel-link');
        
        hiredLink.addEventListener('click', function(e) {
            e.preventDefault();
            currentSection = 'hired';
            checkAuthAndShowSection('hired');
        });
        
        jobsLink.addEventListener('click', function(e) {
            e.preventDefault();
            currentSection = 'jobs';
            checkAuthAndShowSection('jobs');
        });
        
        adminPanelLink.addEventListener('click', function(e) {
            e.preventDefault();
            checkAuthAndShowSection('admin');
        });
        
        // Other navigation links
        document.querySelectorAll('a[href^="#"]').forEach(link => {
            if (link.id === 'hired-link' || link.id === 'jobs-link' || 
                link.id === 'admin-panel-link' || link.id === 'login-btn' || 
                link.id === 'logout-btn' || link.id === 'feedback-link' || 
                link.id === 'footer-feedback-link') {
                return; // Skip already handled links
            }
            
            link.addEventListener('click', function(e) {
                e.preventDefault();
                const target = this.getAttribute('href').substring(1);
                showSection(target);
            });
        });
        
        function checkAuthAndShowSection(section) {
            // Check if user is logged in
            if (currentUser && currentUser.role === 'admin') {
                showSection(section);
            } else {
                // Show login modal
                document.getElementById('loginModal').style.display = 'block';
                currentSection = section;
            }
        }
    }

    function showSection(section) {
        // Hide all sections first
        document.querySelectorAll('.hero-image, .stats-section, .carousel-section, .categories-section, .body, .about-section, .testimonials-section, .hired-section, .jobs-section, .contact-section, #job-posting-form, .admin-dashboard').forEach(el => {
            el.style.display = 'none';
        });
        
        // Show the requested section
        switch (section) {
            case 'home':
                document.querySelector('.hero-image').style.display = 'flex';
                document.querySelector('.stats-section').style.display = 'block';
                document.querySelector('.carousel-section').style.display = 'block';
                document.querySelector('.categories-section').style.display = 'block';
                document.querySelector('.body').style.display = 'block';
                window.scrollTo(0, 0);
                break;
                
            case 'category':
                document.querySelector('.carousel-section').scrollIntoView({
                    behavior: 'smooth'
                });
                break;
                
            case 'about':
                document.querySelector('.about-section').style.display = 'block';
                window.scrollTo(0, 0);
                break;
                
            case 'testimonials':
                document.querySelector('.testimonials-section').style.display = 'block';
                window.scrollTo(0, 0);
                break;
                
            case 'contact':
                document.querySelector('.contact-section').style.display = 'block';
                window.scrollTo(0, 0);
                break;
                
            case 'hired':
                document.querySelector('.hired-section').style.display = 'block';
                displayHiredWorkers();
                window.scrollTo(0, 0);
                break;
                
            case 'jobs':
                document.querySelector('.jobs-section').style.display = 'block';
                displayPostedJobs();
                window.scrollTo(0, 0);
                break;
                
            case 'post-job':
                document.getElementById('job-posting-form').style.display = 'block';
                window.scrollTo(0, 0);
                break;
                
            case 'admin':
                document.querySelector('.admin-dashboard').style.display = 'block';
                updateDashboardStats();
                displayAdminWorkers();
                displayAdminJobs();
                window.scrollTo(0, 0);
                break;
                
            default:
                showSection('home');
        }
    }

    async function displayHiredWorkers() {
        const hiredWorkersList = document.getElementById('hired-workers');
        if (!hiredWorkersList) return;
        
        // Show skeleton loading
        hiredWorkersList.innerHTML = `
            <div class="skeleton-card"></div>
            <div class="skeleton-card"></div>
            <div class="skeleton-card"></div>
        `;
        
        try {
            const db = await dbPromise;
            const transaction = db.transaction(['workers'], 'readonly');
            const store = transaction.objectStore('workers');
            const request = store.getAll();
            
            request.onsuccess = (event) => {
                const workers = event.target.result;
                hiredWorkersList.innerHTML = '';
                
                if (workers.length === 0) {
                    hiredWorkersList.innerHTML = '<p style="grid-column: 1/-1; text-align: center;">No workers registered yet.</p>';
                    return;
                }
                
                workers.forEach((worker, index) => {
                    const workerCard = document.createElement('div');
                    workerCard.className = 'hired-card';
                    workerCard.innerHTML = `
                        <h3>${worker.fullName}</h3>
                        <p><strong>Service:</strong> ${worker.workerType}</p>
                        <p><strong>Email:</strong> ${worker.email}</p>
                        <p><strong>Phone:</strong> ${worker.phone}</p>
                        <p><strong>Location:</strong> ${worker.district}, ${worker.city}</p>
                        <p><strong>Experience:</strong> ${worker.experience} years</p>
                        ${worker.rating ? `<div class="rating">
                            ${generateRatingStars(worker.rating)}
                            <span>${worker.rating.toFixed(1)} (${worker.completedJobs || 0})</span>
                        </div>` : ''}
                        <span class="worker-type">${worker.workerType}</span>
                        <div class="action-buttons">
                            <button class="view-btn" data-id="${worker.id}">
                                <i class="fas fa-eye"></i> View
                            </button>
                            <button class="accept-btn" data-id="${worker.id}">
                                <i class="fas fa-check"></i> Accept
                            </button>
                            <button class="decline-btn" data-id="${worker.id}">
                                <i class="fas fa-times"></i> Decline
                            </button>
                        </div>
                    `;
                    hiredWorkersList.appendChild(workerCard);
                });
                
                // Add event listeners to action buttons
                document.querySelectorAll('.view-btn').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const id = parseInt(this.getAttribute('data-id'));
                        viewWorkerDetails(id);
                    });
                });
                
                document.querySelectorAll('.accept-btn').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const id = parseInt(this.getAttribute('data-id'));
                        acceptWorker(id);
                    });
                });
                
                document.querySelectorAll('.decline-btn').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const id = parseInt(this.getAttribute('data-id'));
                        showConfirmation(id, 'worker');
                    });
                });
            };
            
            request.onerror = (event) => {
                console.error('Error fetching workers:', event.target.error);
                hiredWorkersList.innerHTML = '<p style="grid-column: 1/-1; text-align: center; color: var(--danger-color);">Failed to load workers. Please try again.</p>';
            };
        } catch (error) {
            console.error('Error:', error);
            hiredWorkersList.innerHTML = '<p style="grid-column: 1/-1; text-align: center; color: var(--danger-color);">An error occurred. Please refresh the page.</p>';
        }
    }

    async function displayPostedJobs() {
        const postedJobsList = document.getElementById('posted-jobs');
        if (!postedJobsList) return;
        
        // Show skeleton loading
        postedJobsList.innerHTML = `
            <div class="skeleton-card"></div>
            <div class="skeleton-card"></div>
            <div class="skeleton-card"></div>
        `;
        
        try {
            const db = await dbPromise;
            const transaction = db.transaction(['jobs'], 'readonly');
            const store = transaction.objectStore('jobs');
            const request = store.getAll();
            
            request.onsuccess = (event) => {
                const jobs = event.target.result;
                postedJobsList.innerHTML = '';
                
                if (jobs.length === 0) {
                    postedJobsList.innerHTML = '<p style="grid-column: 1/-1; text-align: center;">No jobs posted yet.</p>';
                    return;
                }
                
                jobs.forEach((job, index) => {
                    const jobCard = document.createElement('div');
                    jobCard.className = 'job-card';
                    jobCard.innerHTML = `
                        <h3>${job.jobTitle}</h3>
                        <p><strong>Category:</strong> ${job.jobCategory}</p>
                        <p><strong>Type:</strong> ${job.jobType}</p>
                        <p><strong>Location:</strong> ${job.jobDistrict}, ${job.jobCity}</p>
                        <p><strong>Budget:</strong> LKR ${job.budget}</p>
                        <p><strong>Urgency:</strong> ${job.urgency}</p>
                        <p><strong>Start Date:</strong> ${formatDate(job.startDate)}</p>
                        ${job.endDate ? `<p><strong>End Date:</strong> ${formatDate(job.endDate)}</p>` : ''}
                        <p><strong>Posted By:</strong> ${job.clientName}</p>
                        <p><strong>Contact:</strong> ${job.clientEmail} | ${job.clientPhone}</p>
                        <span class="job-type">${job.jobType}</span>
                        <div class="action-buttons">
                            <button class="view-btn" data-id="${job.id}">
                                <i class="fas fa-eye"></i> View
                            </button>
                            <button class="accept-btn" data-id="${job.id}">
                                <i class="fas fa-check"></i> Accept
                            </button>
                            <button class="decline-btn" data-id="${job.id}">
                                <i class="fas fa-times"></i> Decline
                            </button>
                        </div>
                    `;
                    postedJobsList.appendChild(jobCard);
                });
                
                // Add event listeners to action buttons
                document.querySelectorAll('.view-btn').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const id = parseInt(this.getAttribute('data-id'));
                        viewJobDetails(id);
                    });
                });
                
                document.querySelectorAll('.accept-btn').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const id = parseInt(this.getAttribute('data-id'));
                        acceptJob(id);
                    });
                });
                
                document.querySelectorAll('.decline-btn').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const id = parseInt(this.getAttribute('data-id'));
                        showConfirmation(id, 'job');
                    });
                });
            };
            
            request.onerror = (event) => {
                console.error('Error fetching jobs:', event.target.error);
                postedJobsList.innerHTML = '<p style="grid-column: 1/-1; text-align: center; color: var(--danger-color);">Failed to load jobs. Please try again.</p>';
            };
        } catch (error) {
            console.error('Error:', error);
            postedJobsList.innerHTML = '<p style="grid-column: 1/-1; text-align: center; color: var(--danger-color);">An error occurred. Please refresh the page.</p>';
        }
    }

    async function viewWorkerDetails(id) {
        try {
            const db = await dbPromise;
            const transaction = db.transaction(['workers'], 'readonly');
            const store = transaction.objectStore('workers');
            const request = store.get(id);
            
            request.onsuccess = (event) => {
                const worker = event.target.result;
                if (!worker) {
                    showErrorMessage('Worker not found');
                    return;
                }
                
                let detailsHtml = `
                    <h3>${worker.fullName}</h3>
                    <p><strong>Service:</strong> ${worker.workerType}</p>
                    <p><strong>Email:</strong> ${worker.email}</p>
                    <p><strong>Phone:</strong> ${worker.phone}</p>
                    <p><strong>NIC:</strong> ${worker.nic}</p>
                    <p><strong>Birth Date:</strong> ${formatDate(worker.birthDate)}</p>
                    <p><strong>Gender:</strong> ${worker.gender}</p>
                    <p><strong>Location:</strong> ${worker.district}, ${worker.city}</p>
                    <p><strong>Address:</strong> ${worker.street}, ${worker.postalCode}</p>
                    <p><strong>Experience:</strong> ${worker.experience} years</p>
                    <p><strong>Skills:</strong> ${worker.skills || 'Not specified'}</p>
                    <p><strong>Hourly Rate:</strong> ${worker.hourlyRate ? 'LKR ' + worker.hourlyRate : 'Not specified'}</p>
                    ${worker.rating ? `<p><strong>Rating:</strong> ${worker.rating.toFixed(1)} (${worker.completedJobs || 0} jobs)</p>` : ''}
                `;
                
                if (worker.profilePic) {
                    detailsHtml = `
                        <div style="display: flex; gap: 1rem; margin-bottom: 1rem;">
                            <img src="${worker.profilePic}" alt="${worker.fullName}" style="width: 100px; height: 100px; border-radius: 50%; object-fit: cover; border: 3px solid var(--primary-color);">
                            <div>${detailsHtml}</div>
                        </div>
                    `;
                }
                
                // Create a modal to display these details
                const modal = document.createElement('div');
                modal.className = 'modal';
                modal.style.display = 'block';
                modal.innerHTML = `
                    <div class="modal-content" style="max-width: 700px;">
                        <div class="modal-header">
                            <h2>Worker Details</h2>
                            <span class="close-modal">&times;</span>
                        </div>
                        <div style="padding: 1rem;">
                            ${detailsHtml}
                            <div style="margin-top: 1.5rem;">
                                <button class="btn btn-primary" style="width: auto; padding: 0.5rem 1rem;">
                                    <i class="fas fa-envelope"></i> Contact Worker
                                </button>
                            </div>
                        </div>
                    </div>
                `;
                
                document.body.appendChild(modal);
                
                // Close modal when clicking X
                modal.querySelector('.close-modal').addEventListener('click', function() {
                    modal.style.display = 'none';
                    document.body.removeChild(modal);
                });
                
                // Close modal when clicking outside
                window.addEventListener('click', function(event) {
                    if (event.target === modal) {
                        modal.style.display = 'none';
                        document.body.removeChild(modal);
                    }
                });
            };
        } catch (error) {
            console.error('Error:', error);
            showErrorMessage('Failed to load worker details');
        }
    }

    async function viewJobDetails(id) {
        try {
            const db = await dbPromise;
            const transaction = db.transaction(['jobs'], 'readonly');
            const store = transaction.objectStore('jobs');
            const request = store.get(id);
            
            request.onsuccess = (event) => {
                const job = event.target.result;
                if (!job) {
                    showErrorMessage('Job not found');
                    return;
                }
                
                let detailsHtml = `
                    <h3>${job.jobTitle}</h3>
                    <p><strong>Category:</strong> ${job.jobCategory}</p>
                    <p><strong>Type:</strong> ${job.jobType}</p>
                    <p><strong>Description:</strong> ${job.jobDescription}</p>
                    <p><strong>Location:</strong> ${job.jobDistrict}, ${job.jobCity}</p>
                    <p><strong>Address:</strong> ${job.jobAddress || 'Not specified'}</p>
                    <p><strong>Budget:</strong> LKR ${job.budget}</p>
                    <p><strong>Urgency:</strong> ${job.urgency}</p>
                    <p><strong>Start Date:</strong> ${formatDate(job.startDate)}</p>
                    ${job.endDate ? `<p><strong>End Date:</strong> ${formatDate(job.endDate)}</p>` : ''}
                    <p><strong>Posted By:</strong> ${job.clientName}</p>
                    <p><strong>Contact Email:</strong> ${job.clientEmail}</p>
                    <p><strong>Contact Phone:</strong> ${job.clientPhone}</p>
                    <p><strong>Status:</strong> <span style="color: ${job.status === 'open' ? 'var(--success-color)' : 'var(--text-light)'}">${job.status}</span></p>
                `;
                
                // Create a modal to display these details
                const modal = document.createElement('div');
                modal.className = 'modal';
                modal.style.display = 'block';
                modal.innerHTML = `
                    <div class="modal-content" style="max-width: 700px;">
                        <div class="modal-header">
                            <h2>Job Details</h2>
                            <span class="close-modal">&times;</span>
                        </div>
                        <div style="padding: 1rem;">
                            ${detailsHtml}
                            <div style="margin-top: 1.5rem;">
                                <button class="btn btn-primary" style="width: auto; padding: 0.5rem 1rem;">
                                    <i class="fas fa-envelope"></i> Contact Client
                                </button>
                                ${job.status === 'open' ? `
                                <button class="btn btn-secondary" style="width: auto; padding: 0.5rem 1rem; margin-left: 0.5rem;">
                                    <i class="fas fa-briefcase"></i> Apply for Job
                                </button>
                                ` : ''}
                            </div>
                        </div>
                    </div>
                `;
                
                document.body.appendChild(modal);
                
                // Close modal when clicking X
                modal.querySelector('.close-modal').addEventListener('click', function() {
                    modal.style.display = 'none';
                    document.body.removeChild(modal);
                });
                
                // Close modal when clicking outside
                window.addEventListener('click', function(event) {
                    if (event.target === modal) {
                        modal.style.display = 'none';
                        document.body.removeChild(modal);
                    }
                });
            };
        } catch (error) {
            console.error('Error:', error);
            showErrorMessage('Failed to load job details');
        }
    }

    async function acceptWorker(id) {
        try {
            const db = await dbPromise;
            const transaction = db.transaction(['workers'], 'readwrite');
            const store = transaction.objectStore('workers');
            const request = store.get(id);
            
            request.onsuccess = (event) => {
                const worker = event.target.result;
                if (!worker) {
                    showErrorMessage('Worker not found');
                    return;
                }
                
                // Update worker status
                worker.status = 'active';
                const updateRequest = store.put(worker);
                
                updateRequest.onsuccess = () => {
                    showSuccessMessage(`Worker ${worker.fullName} has been accepted!`);
                    displayHiredWorkers();
                    updateDashboardStats();
                    
                    // Simulate sending notification
                    if ('Notification' in window && Notification.permission === 'granted') {
                        new Notification('Worker Accepted', {
                            body: `You've accepted ${worker.fullName} for a job. Contact them at ${worker.phone}`,
                            icon: worker.profilePic || 'https://via.placeholder.com/64'
                        });
                    }
                };
            };
        } catch (error) {
            console.error('Error:', error);
            showErrorMessage('Failed to accept worker');
        }
    }

    async function acceptJob(id) {
        try {
            const db = await dbPromise;
            const transaction = db.transaction(['jobs'], 'readwrite');
            const store = transaction.objectStore('jobs');
            const request = store.get(id);
            
            request.onsuccess = (event) => {
                const job = event.target.result;
                if (!job) {
                    showErrorMessage('Job not found');
                    return;
                }
                
                // Update job status
                job.status = 'accepted';
                const updateRequest = store.put(job);
                
                updateRequest.onsuccess = () => {
                    showSuccessMessage(`Job "${job.jobTitle}" has been accepted!`);
                    displayPostedJobs();
                    updateDashboardStats();
                    
                    // Simulate sending notification
                    if ('Notification' in window && Notification.permission === 'granted') {
                        new Notification('Job Accepted', {
                            body: `You've accepted the job "${job.jobTitle}". Contact client at ${job.clientPhone}`,
                            icon: 'https://via.placeholder.com/64'
                        });
                    }
                };
            };
        } catch (error) {
            console.error('Error:', error);
            showErrorMessage('Failed to accept job');
        }
    }

    function showConfirmation(id, type) {
        itemToDelete = id;
        deleteType = type;
        
        const confirmationModal = document.getElementById('confirmationModal');
        const content = confirmationModal.querySelector('.confirmation-content');
        
        if (type === 'worker') {
            // Get worker details for confirmation message
            const dbPromise = setupDatabase();
            dbPromise.then(db => {
                const transaction = db.transaction(['workers'], 'readonly');
                const store = transaction.objectStore('workers');
                const request = store.get(id);
                
                request.onsuccess = (event) => {
                    const worker = event.target.result;
                    if (worker) {
                        content.querySelector('h3').textContent = 'Confirm Worker Removal';
                        content.querySelector('p').textContent = `Are you sure you want to remove ${worker.fullName} from your hired workers? This action cannot be undone.`;
                        confirmationModal.style.display = 'block';
                    }
                };
            });
        } else if (type === 'job') {
            // Get job details for confirmation message
            const dbPromise = setupDatabase();
            dbPromise.then(db => {
                const transaction = db.transaction(['jobs'], 'readonly');
                const store = transaction.objectStore('jobs');
                const request = store.get(id);
                
                request.onsuccess = (event) => {
                    const job = event.target.result;
                    if (job) {
                        content.querySelector('h3').textContent = 'Confirm Job Removal';
                        content.querySelector('p').textContent = `Are you sure you want to remove the job "${job.jobTitle}"? This action cannot be undone.`;
                        confirmationModal.style.display = 'block';
                    }
                };
            });
        }
    }

    function initSearch() {
        const searchInput = document.createElement('input');
        searchInput.type = 'search';
        searchInput.placeholder = 'Search workers or jobs...';
        searchInput.style.padding = '0.5rem 1rem';
        searchInput.style.borderRadius = '20px';
        searchInput.style.border = '1px solid #ddd';
        searchInput.style.width = '250px';
        searchInput.style.marginLeft = 'auto';
        
        // Add search input to navbar
        const navbar = document.querySelector('.navbar');
        navbar.insertBefore(searchInput, document.querySelector('.hamburger'));
        
        // Search functionality
        searchInput.addEventListener('input', debounce(async function(e) {
            const query = e.target.value.trim().toLowerCase();
            if (query.length < 2) return;
            
            try {
                const db = await dbPromise;
                
                // Search workers
                const workersTx = db.transaction(['workers'], 'readonly');
                const workersStore = workersTx.objectStore('workers');
                const workersRequest = workersStore.getAll();
                
                // Search jobs
                const jobsTx = db.transaction(['jobs'], 'readonly');
                const jobsStore = jobsTx.objectStore('jobs');
                const jobsRequest = jobsStore.getAll();
                
                const [workers, jobs] = await Promise.all([
                    new Promise(resolve => {
                        workersRequest.onsuccess = () => resolve(workersRequest.result);
                    }),
                    new Promise(resolve => {
                        jobsRequest.onsuccess = () => resolve(jobsRequest.result);
                    })
                ]);
                
                const filteredWorkers = workers.filter(worker => 
                    worker.fullName.toLowerCase().includes(query) ||
                    worker.workerType.toLowerCase().includes(query) ||
                    worker.district.toLowerCase().includes(query) ||
                    (worker.skills && worker.skills.toLowerCase().includes(query))
                );
                
                const filteredJobs = jobs.filter(job => 
                    job.jobTitle.toLowerCase().includes(query) ||
                    job.jobCategory.toLowerCase().includes(query) ||
                    job.jobDistrict.toLowerCase().includes(query) ||
                    job.jobDescription.toLowerCase().includes(query)
                );
                
                // Display search results
                displaySearchResults(filteredWorkers, filteredJobs);
            } catch (error) {
                console.error('Search error:', error);
            }
        }, 300));
    }

    function displaySearchResults(workers, jobs) {
        // Create a modal to display search results
        const modal = document.createElement('div');
        modal.className = 'modal';
        modal.style.display = 'block';
        modal.style.paddingTop = '80px';
        modal.style.alignItems = 'flex-start';
        
        let resultsHtml = `
            <div class="modal-content" style="max-width: 800px; max-height: 80vh; overflow-y: auto;">
                <div class="modal-header">
                    <h2>Search Results</h2>
                    <span class="close-modal">&times;</span>
                </div>
                <div style="padding: 1rem;">
        `;
        
        if (workers.length > 0) {
            resultsHtml += `
                <h3 style="margin-top: 0;">Workers (${workers.length})</h3>
                <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 1rem; margin-bottom: 2rem;">
            `;
            
            workers.slice(0, 3).forEach(worker => {
                resultsHtml += `
                    <div class="hired-card" style="cursor: pointer;">
                        <h3>${worker.fullName}</h3>
                        <p><strong>Service:</strong> ${worker.workerType}</p>
                        <p><strong>Location:</strong> ${worker.district}</p>
                        ${worker.rating ? `<div class="rating">
                            ${generateRatingStars(worker.rating)}
                            <span>${worker.rating.toFixed(1)} (${worker.completedJobs || 0})</span>
                        </div>` : ''}
                        <button class="btn btn-primary" style="width: 100%; margin-top: 0.5rem;" data-worker-id="${worker.id}">
                            View Profile
                        </button>
                    </div>
                `;
            });
            
            resultsHtml += `</div>`;
            
            if (workers.length > 3) {
                resultsHtml += `<p>+ ${workers.length - 3} more workers found...</p>`;
            }
        }
        
        if (jobs.length > 0) {
            resultsHtml += `
                <h3>Jobs (${jobs.length})</h3>
                <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 1rem;">
            `;
            
            jobs.slice(0, 3).forEach(job => {
                resultsHtml += `
                    <div class="job-card" style="cursor: pointer;">
                        <h3>${job.jobTitle}</h3>
                        <p><strong>Category:</strong> ${job.jobCategory}</p>
                        <p><strong>Location:</strong> ${job.jobDistrict}</p>
                        <p><strong>Budget:</strong> LKR ${job.budget}</p>
                        <button class="btn btn-primary" style="width: 100%; margin-top: 0.5rem;" data-job-id="${job.id}">
                            View Job
                        </button>
                    </div>
                `;
            });
            
            resultsHtml += `</div>`;
            
            if (jobs.length > 3) {
                resultsHtml += `<p>+ ${jobs.length - 3} more jobs found...</p>`;
            }
        }
        
        if (workers.length === 0 && jobs.length === 0) {
            resultsHtml += `<p>No results found. Try a different search term.</p>`;
        }
        
        resultsHtml += `
                </div>
            </div>
        `;
        
        modal.innerHTML = resultsHtml;
        document.body.appendChild(modal);
        
        // Close modal when clicking X
        modal.querySelector('.close-modal').addEventListener('click', function() {
            modal.style.display = 'none';
            document.body.removeChild(modal);
        });
        
        // Close modal when clicking outside
        window.addEventListener('click', function(event) {
            if (event.target === modal) {
                modal.style.display = 'none';
                document.body.removeChild(modal);
            }
        });
        
        // Add click handlers for view buttons
        modal.querySelectorAll('[data-worker-id]').forEach(btn => {
            btn.addEventListener('click', function() {
                const id = parseInt(this.getAttribute('data-worker-id'));
                modal.style.display = 'none';
                document.body.removeChild(modal);
                viewWorkerDetails(id);
            });
        });
        
        modal.querySelectorAll('[data-job-id]').forEach(btn => {
            btn.addEventListener('click', function() {
                const id = parseInt(this.getAttribute('data-job-id'));
                modal.style.display = 'none';
                document.body.removeChild(modal);
                viewJobDetails(id);
            });
        });
    }

    function initLocationServices() {
        if ('geolocation' in navigator) {
            const locationBtn = document.createElement('button');
            locationBtn.innerHTML = '<i class="fas fa-map-marker-alt"></i> Find Nearby Workers';
            locationBtn.className = 'btn btn-secondary';
            locationBtn.style.marginLeft = '1rem';
            
            // Add location button to hero section
            const heroButtons = document.querySelector('.hero-buttons');
            heroButtons.appendChild(locationBtn);
            
            locationBtn.addEventListener('click', function() {
                // Show loading state
                locationBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Locating...';
                locationBtn.disabled = true;
                
                navigator.geolocation.getCurrentPosition(
                    async (position) => {
                        const { latitude, longitude } = position.coords;
                        
                        try {
                            // In a real app, this would query your backend with the coordinates
                            // For this demo, we'll just show workers in the same district
                            const db = await dbPromise;
                            const transaction = db.transaction(['workers'], 'readonly');
                            const store = transaction.objectStore('workers');
                            const request = store.getAll();
                            
                            request.onsuccess = (event) => {
                                const allWorkers = event.target.result;
                                
                                // Simulate finding workers within 10km (in a real app, you'd calculate distance)
                                const nearbyWorkers = allWorkers.slice(0, 5).map(worker => ({
                                    ...worker,
                                    distance: (Math.random() * 9 + 1).toFixed(1) // Random distance 1-10km
                                }));
                                
                                displayNearbyWorkers(nearbyWorkers, latitude, longitude);
                            };
                        } catch (error) {
                            console.error('Error:', error);
                            showErrorMessage('Failed to find nearby workers');
                        } finally {
                            locationBtn.innerHTML = '<i class="fas fa-map-marker-alt"></i> Find Nearby Workers';
                            locationBtn.disabled = false;
                        }
                    },
                    (error) => {
                        console.error('Geolocation error:', error);
                        showErrorMessage('Could not determine your location. Please enable location services.');
                        locationBtn.innerHTML = '<i class="fas fa-map-marker-alt"></i> Find Nearby Workers';
                        locationBtn.disabled = false;
                    },
                    { timeout: 10000 }
                );
            });
        }
    }

    function displayNearbyWorkers(workers, lat, lng) {
        const modal = document.createElement('div');
        modal.className = 'modal';
        modal.style.display = 'block';
        modal.style.paddingTop = '80px';
        modal.style.alignItems = 'flex-start';
        
        let resultsHtml = `
            <div class="modal-content" style="max-width: 800px; max-height: 80vh; overflow-y: auto;">
                <div class="modal-header">
                    <h2>Workers Near You</h2>
                    <span class="close-modal">&times;</span>
                </div>
                <div style="padding: 1rem;">
                    <div id="map" style="height: 200px; background-color: #eee; margin-bottom: 1rem; display: flex; align-items: center; justify-content: center;">
                        <p>Map would display here with your location</p>
                    </div>
                    <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 1rem;">
        `;
        
        workers.forEach(worker => {
            resultsHtml += `
                <div class="hired-card">
                    <h3>${worker.fullName}</h3>
                    <p><strong>Service:</strong> ${worker.workerType}</p>
                    <p><strong>Distance:</strong> ${worker.distance} km away</p>
                    <p><strong>Rating:</strong> ${worker.rating ? worker.rating.toFixed(1) : 'Not rated yet'}</p>
                    <button class="btn btn-primary" style="width: 100%; margin-top: 0.5rem;" data-worker-id="${worker.id}">
                        Contact Worker
                    </button>
                </div>
            `;
        });
        
        resultsHtml += `
                    </div>
                </div>
            </div>
        `;
        
        modal.innerHTML = resultsHtml;
        document.body.appendChild(modal);
        
        // Close modal when clicking X
        modal.querySelector('.close-modal').addEventListener('click', function() {
            modal.style.display = 'none';
            document.body.removeChild(modal);
        });
        
        // Close modal when clicking outside
        window.addEventListener('click', function(event) {
            if (event.target === modal) {
                modal.style.display = 'none';
                document.body.removeChild(modal);
            }
        });
    }

    function initDarkMode() {
        const darkModeToggle = document.createElement('div');
        darkModeToggle.innerHTML = '<i class="fas fa-moon"></i>';
        darkModeToggle.style.cursor = 'pointer';
        darkModeToggle.style.marginLeft = '1rem';
        darkModeToggle.style.fontSize = '1.2rem';
        
        // Add dark mode toggle to navbar
        const navbar = document.querySelector('.navbar');
        navbar.insertBefore(darkModeToggle, document.querySelector('.hamburger'));
        
        // Check for saved theme preference
        const currentTheme = localStorage.getItem('theme') || 'light';
        if (currentTheme === 'dark') {
            document.body.classList.add('dark-mode');
            darkModeToggle.innerHTML = '<i class="fas fa-sun"></i>';
        }
        
        darkModeToggle.addEventListener('click', function() {
            document.body.classList.toggle('dark-mode');
            
            if (document.body.classList.contains('dark-mode')) {
                localStorage.setItem('theme', 'dark');
                darkModeToggle.innerHTML = '<i class="fas fa-sun"></i>';
            } else {
                localStorage.setItem('theme', 'light');
                darkModeToggle.innerHTML = '<i class="fas fa-moon"></i>';
            }
        });
    }

    function initAdminDashboard() {
        // Initialize tabs in admin dashboard
        const tabButtons = document.querySelectorAll('.admin-action-btn[data-tab]');
        const tabContents = document.querySelectorAll('.tab-content');
        
        tabButtons.forEach(button => {
            button.addEventListener('click', function() {
                // Remove active class from all buttons
                tabButtons.forEach(btn => btn.classList.remove('active'));
                
                // Add active class to clicked button
                this.classList.add('active');
                
                // Hide all tab contents
                tabContents.forEach(content => content.style.display = 'none');
                
                // Show the selected tab content
                const tabId = this.getAttribute('data-tab');
                document.getElementById(tabId).style.display = 'block';
            });
        });
        
        // Initialize filters
        const filterStatusSelect = document.getElementById('filter-status');
        const filterCategorySelect = document.getElementById('filter-category');
        const filterSearchInput = document.getElementById('filter-search');
        const applyFiltersBtn = document.getElementById('apply-filters');
        
        applyFiltersBtn.addEventListener('click', function() {
            const status = filterStatusSelect.value;
            const category = filterCategorySelect.value;
            const search = filterSearchInput.value.trim().toLowerCase();
            
            // Apply filters based on active tab
            const activeTab = document.querySelector('.admin-action-btn.active[data-tab]').getAttribute('data-tab');
            
            if (activeTab === 'workers-tab') {
                displayAdminWorkers(status, category, search);
            } else if (activeTab === 'jobs-tab') {
                displayAdminJobs(status, category, search);
            }
        });
        
        // Export data button
        const exportDataBtn = document.getElementById('export-data');
        
        exportDataBtn.addEventListener('click', function() {
            const activeTab = document.querySelector('.admin-action-btn.active[data-tab]').getAttribute('data-tab');
            
            if (activeTab === 'workers-tab') {
                exportWorkersData();
            } else if (activeTab === 'jobs-tab') {
                exportJobsData();
            }
        });
    }

    async function updateDashboardStats() {
        try {
            const db = await dbPromise;
            
            // Get workers count
            const workersTx = db.transaction(['workers'], 'readonly');
            const workersStore = workersTx.objectStore('workers');
            const workersRequest = workersStore.getAll();
            
            // Get jobs count
            const jobsTx = db.transaction(['jobs'], 'readonly');
            const jobsStore = jobsTx.objectStore('jobs');
            const jobsRequest = jobsStore.getAll();
            
            const [workers, jobs] = await Promise.all([
                new Promise(resolve => {
                    workersRequest.onsuccess = () => resolve(workersRequest.result);
                }),
                new Promise(resolve => {
                    jobsRequest.onsuccess = () => resolve(jobsRequest.result);
                })
            ]);
            
            // Update stats in dashboard
            document.getElementById('total-workers').textContent = workers.length;
            document.getElementById('total-jobs').textContent = jobs.length;
            document.getElementById('active-workers').textContent = workers.filter(w => w.status === 'active').length;
            document.getElementById('pending-approvals').textContent = workers.filter(w => w.status === 'pending').length;
        } catch (error) {
            console.error('Error updating dashboard stats:', error);
        }
    }

    async function displayAdminWorkers(status = 'all', category = 'all', search = '') {
        const workersListElement = document.getElementById('admin-workers-list');
        if (!workersListElement) return;
        
        // Show loading
        workersListElement.innerHTML = `
            <div class="skeleton-card"></div>
            <div class="skeleton-card"></div>
            <div class="skeleton-card"></div>
        `;
        
        try {
            const db = await dbPromise;
            const transaction = db.transaction(['workers'], 'readonly');
            const store = transaction.objectStore('workers');
            const request = store.getAll();
            
            request.onsuccess = (event) => {
                let workers = event.target.result;
                
                // Apply filters
                if (status !== 'all') {
                    workers = workers.filter(worker => worker.status === status);
                }
                
                if (category !== 'all') {
                    workers = workers.filter(worker => worker.workerType === category);
                }
                
                if (search) {
                    workers = workers.filter(worker => 
                        worker.fullName.toLowerCase().includes(search) ||
                        worker.email.toLowerCase().includes(search) ||
                        worker.phone.includes(search) ||
                        (worker.skills && worker.skills.toLowerCase().includes(search))
                    );
                }
                
                workersListElement.innerHTML = '';
                
                if (workers.length === 0) {
                    workersListElement.innerHTML = '<p style="grid-column: 1/-1; text-align: center;">No workers found matching your filters.</p>';
                    return;
                }
                
                workers.forEach(worker => {
                    const workerCard = document.createElement('div');
                    workerCard.className = 'hired-card';
                    workerCard.innerHTML = `
                        <h3>${worker.fullName} 
                            <span class="status-badge ${getStatusClass(worker.status)}">${worker.status}</span>
                        </h3>
                        <p><strong>Service:</strong> ${worker.workerType}</p>
                        <p><strong>Email:</strong> ${worker.email}</p>
                        <p><strong>Phone:</strong> ${worker.phone}</p>
                        <p><strong>Location:</strong> ${worker.district}, ${worker.city}</p>
                        <p><strong>Experience:</strong> ${worker.experience} years</p>
                        <p><strong>Registered:</strong> ${formatDate(worker.registrationDate)}</p>
                        <span class="worker-type">${worker.workerType}</span>
                        <div class="action-buttons">
                            <button class="view-btn" data-id="${worker.id}">
                                <i class="fas fa-eye"></i> View
                            </button>
                            <button class="admin-action-btn" data-id="${worker.id}" data-action="approve">
                                <i class="fas fa-check"></i> Approve
                            </button>
                            <button class="decline-btn" data-id="${worker.id}">
                                <i class="fas fa-times"></i> Remove
                            </button>
                        </div>
                    `;
                    workersListElement.appendChild(workerCard);
                });
                
                // Add event listeners to action buttons
                workersListElement.querySelectorAll('.view-btn').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const id = parseInt(this.getAttribute('data-id'));
                        viewWorkerDetails(id);
                    });
                });
                
                workersListElement.querySelectorAll('[data-action="approve"]').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const id = parseInt(this.getAttribute('data-id'));
                        acceptWorker(id);
                    });
                });
                
                workersListElement.querySelectorAll('.decline-btn').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const id = parseInt(this.getAttribute('data-id'));
                        showConfirmation(id, 'worker');
                    });
                });
            };
        } catch (error) {
            console.error('Error fetching workers for admin:', error);
            workersListElement.innerHTML = '<p style="grid-column: 1/-1; text-align: center; color: var(--danger-color);">Failed to load workers. Please try again.</p>';
        }
    }

    async function displayAdminJobs(status = 'all', category = 'all', search = '') {
        const jobsListElement = document.getElementById('admin-jobs-list');
        if (!jobsListElement) return;
        
        // Show loading
        jobsListElement.innerHTML = `
            <div class="skeleton-card"></div>
            <div class="skeleton-card"></div>
            <div class="skeleton-card"></div>
        `;
        
        try {
            const db = await dbPromise;
            const transaction = db.transaction(['jobs'], 'readonly');
            const store = transaction.objectStore('jobs');
            const request = store.getAll();
            
            request.onsuccess = (event) => {
                let jobs = event.target.result;
                
                // Apply filters
                if (status !== 'all') {
                    jobs = jobs.filter(job => job.status === status);
                }
                
                if (category !== 'all') {
                    jobs = jobs.filter(job => job.jobCategory === category);
                }
                
                if (search) {
                    jobs = jobs.filter(job => 
                        job.jobTitle.toLowerCase().includes(search) ||
                        job.jobDescription.toLowerCase().includes(search) ||
                        job.clientName.toLowerCase().includes(search) ||
                        job.clientEmail.toLowerCase().includes(search)
                    );
                }
                
                jobsListElement.innerHTML = '';
                
                if (jobs.length === 0) {
                    jobsListElement.innerHTML = '<p style="grid-column: 1/-1; text-align: center;">No jobs found matching your filters.</p>';
                    return;
                }
                
                jobs.forEach(job => {
                    const jobCard = document.createElement('div');
                    jobCard.className = 'job-card';
                    jobCard.innerHTML = `
                        <h3>${job.jobTitle}
                            <span class="status-badge ${job.status === 'open' ? 'status-active' : 'status-pending'}">${job.status}</span>
                        </h3>
                        <p><strong>Category:</strong> ${job.jobCategory}</p>
                        <p><strong>Type:</strong> ${job.jobType}</p>
                        <p><strong>Location:</strong> ${job.jobDistrict}, ${job.jobCity}</p>
                        <p><strong>Budget:</strong> LKR ${job.budget}</p>
                        <p><strong>Posted:</strong> ${formatDate(job.postedDate)}</p>
                        <p><strong>Client:</strong> ${job.clientName}</p>
                        <span class="job-type">${job.jobType}</span>
                        <div class="action-buttons">
                            <button class="view-btn" data-id="${job.id}">
                                <i class="fas fa-eye"></i> View
                            </button>
                            <button class="admin-action-btn" data-id="${job.id}" data-action="assign">
                                <i class="fas fa-user-plus"></i> Assign
                            </button>
                            <button class="decline-btn" data-id="${job.id}">
                                <i class="fas fa-times"></i> Remove
                            </button>
                        </div>
                    `;
                    jobsListElement.appendChild(jobCard);
                });
                
                // Add event listeners to action buttons
                jobsListElement.querySelectorAll('.view-btn').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const id = parseInt(this.getAttribute('data-id'));
                        viewJobDetails(id);
                    });
                });
                
                jobsListElement.querySelectorAll('[data-action="assign"]').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const id = parseInt(this.getAttribute('data-id'));
                        showAssignWorkerModal(id);
                    });
                });
                
                jobsListElement.querySelectorAll('.decline-btn').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const id = parseInt(this.getAttribute('data-id'));
                        showConfirmation(id, 'job');
                    });
                });
            };
        } catch (error) {
            console.error('Error fetching jobs for admin:', error);
            jobsListElement.innerHTML = '<p style="grid-column: 1/-1; text-align: center; color: var(--danger-color);">Failed to load jobs. Please try again.</p>';
        }
    }

    function getStatusClass(status) {
        switch (status) {
            case 'active':
                return 'status-active';
            case 'pending':
                return 'status-pending';
            case 'rejected':
                return 'status-rejected';
            default:
                return '';
        }
    }

    async function exportWorkersData() {
        try {
            const db = await dbPromise;
            const transaction = db.transaction(['workers'], 'readonly');
            const store = transaction.objectStore('workers');
            const request = store.getAll();
            
            request.onsuccess = (event) => {
                const workers = event.target.result;
                
                // Convert to CSV
                const headers = ['ID', 'Name', 'Email', 'Phone', 'District', 'Service', 'Experience', 'Hourly Rate', 'Status', 'Registration Date'];
                const csvContent = [
                    headers.join(','),
                    ...workers.map(worker => [
                        worker.id,
                        `"${worker.fullName}"`,
                        `"${worker.email}"`,
                        `"${worker.phone}"`,
                        `"${worker.district}"`,
                        `"${worker.workerType}"`,
                        worker.experience,
                        worker.hourlyRate || 'N/A',
                        `"${worker.status}"`,
                        `"${formatDate(worker.registrationDate)}"`
                    ].join(','))
                ].join('\n');
                
                // Create download link
                const blob = new Blob([csvContent], { type: 'text/csv' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `truley_workers_export_${new Date().toISOString().split('T')[0]}.csv`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
                
                showSuccessMessage('Workers data exported successfully!');
            };
        } catch (error) {
            console.error('Error exporting workers data:', error);
            showErrorMessage('Failed to export workers data');
        }
    }

    async function exportJobsData() {
        try {
            const db = await dbPromise;
            const transaction = db.transaction(['jobs'], 'readonly');
            const store = transaction.objectStore('jobs');
            const request = store.getAll();
            
            request.onsuccess = (event) => {
                const jobs = event.target.result;
                
                // Convert to CSV
                const headers = ['ID', 'Job Title', 'Category', 'Type', 'District', 'Budget', 'Urgency', 'Status', 'Client Name', 'Posted Date'];
                const csvContent = [
                    headers.join(','),
                    ...jobs.map(job => [
                        job.id,
                        `"${job.jobTitle}"`,
                        `"${job.jobCategory}"`,
                        `"${job.jobType}"`,
                        `"${job.jobDistrict}"`,
                        job.budget,
                        `"${job.urgency}"`,
                        `"${job.status}"`,
                        `"${job.clientName}"`,
                        `"${formatDate(job.postedDate)}"`
                    ].join(','))
                ].join('\n');
                
                // Create download link
                const blob = new Blob([csvContent], { type: 'text/csv' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `truley_jobs_export_${new Date().toISOString().split('T')[0]}.csv`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
                
                showSuccessMessage('Jobs data exported successfully!');
            };
        } catch (error) {
            console.error('Error exporting jobs data:', error);
            showErrorMessage('Failed to export jobs data');
        }
    }

    async function showAssignWorkerModal(jobId) {
        try {
            const db = await dbPromise;
            
            // Get job details
            const jobTx = db.transaction(['jobs'], 'readonly');
            const jobStore = jobTx.objectStore('jobs');
            const jobRequest = jobStore.get(jobId);
            
            // Get all workers
            const workersTx = db.transaction(['workers'], 'readonly');
            const workersStore = workersTx.objectStore('workers');
            const workersRequest = workersStore.getAll();
            
            const [job, workers] = await Promise.all([
                new Promise(resolve => {
                    jobRequest.onsuccess = () => resolve(jobRequest.result);
                }),
                new Promise(resolve => {
                    workersRequest.onsuccess = () => resolve(workersRequest.result);
                })
            ]);
            
            if (!job) {
                showErrorMessage('Job not found');
                return;
            }
            
            // Filter workers based on job category
            const matchingWorkers = workers.filter(worker => 
                worker.workerType === job.jobCategory ||
                (worker.skills && worker.skills.toLowerCase().includes(job.jobCategory.toLowerCase()))
            );
            
            // Create modal for assigning worker
            const modal = document.createElement('div');
            modal.className = 'modal';
            modal.style.display = 'block';
            
            let modalContent = `
                <div class="modal-content" style="max-width: 700px;">
                    <div class="modal-header">
                        <h2>Assign Worker to Job</h2>
                        <span class="close-modal">&times;</span>
                    </div>
                    <div style="padding: 1rem;">
                        <h3>${job.jobTitle}</h3>
                        <p><strong>Category:</strong> ${job.jobCategory}</p>
                        <p><strong>Location:</strong> ${job.jobDistrict}, ${job.jobCity}</p>
                        <p><strong>Budget:</strong> LKR ${job.budget}</p>
                        
                        <h4 style="margin-top: 1.5rem;">Available Workers</h4>
            `;
            
            if (matchingWorkers.length === 0) {
                modalContent += `<p>No matching workers found for this job category.</p>`;
            } else {
                modalContent += `<div style="max-height: 300px; overflow-y: auto; margin-top: 1rem;">`;
                
                matchingWorkers.forEach(worker => {
                    modalContent += `
                        <div style="border: 1px solid #eee; padding: 1rem; margin-bottom: 0.5rem; border-radius: 8px; display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <p style="font-weight: 600;">${worker.fullName}</p>
                                <p style="font-size: 0.9rem;"><strong>Service:</strong> ${worker.workerType}</p>
                                <p style="font-size: 0.9rem;"><strong>Experience:</strong> ${worker.experience} years</p>
                                <p style="font-size: 0.9rem;"><strong>Location:</strong> ${worker.district}</p>
                            </div>
                            <button class="btn btn-primary assign-worker-btn" style="width: auto; padding: 0.5rem 1rem;" data-worker-id="${worker.id}" data-job-id="${job.id}">
                                Assign
                            </button>
                        </div>
                    `;
                });
                
                modalContent += `</div>`;
            }
            
            modalContent += `
                    </div>
                </div>
            `;
            
            modal.innerHTML = modalContent;
            document.body.appendChild(modal);
            
            // Close modal when clicking X
            modal.querySelector('.close-modal').addEventListener('click', function() {
                modal.style.display = 'none';
                document.body.removeChild(modal);
            });
            
            // Close modal when clicking outside
            window.addEventListener('click', function(event) {
                if (event.target === modal) {
                    modal.style.display = 'none';
                    document.body.removeChild(modal);
                }
            });
            
            // Handle assign worker button clicks
            modal.querySelectorAll('.assign-worker-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const workerId = parseInt(this.getAttribute('data-worker-id'));
                    const jobId = parseInt(this.getAttribute('data-job-id'));
                    assignWorkerToJob(workerId, jobId);
                    modal.style.display = 'none';
                    document.body.removeChild(modal);
                });
            });
        } catch (error) {
            console.error('Error showing assign worker modal:', error);
            showErrorMessage('Failed to load worker assignment options');
        }
    }

    async function assignWorkerToJob(workerId, jobId) {
        try {
            const db = await dbPromise;
            
            // Get worker details
            const workerTx = db.transaction(['workers'], 'readonly');
            const workerStore = workerTx.objectStore('workers');
            const workerRequest = workerStore.get(workerId);
            
            // Get job details
            const jobTx = db.transaction(['jobs'], 'readonly');
            const jobStore = jobTx.objectStore('jobs');
            const jobRequest = jobStore.get(jobId);
            
            const [worker, job] = await Promise.all([
                new Promise(resolve => {
                    workerRequest.onsuccess = () => resolve(workerRequest.result);
                }),
                new Promise(resolve => {
                    jobRequest.onsuccess = () => resolve(jobRequest.result);
                })
            ]);
            
            if (!worker || !job) {
                showErrorMessage('Worker or job not found');
                return;
            }
            
            // Update job status and assigned worker
            job.status = 'assigned';
            job.assignedWorkerId = workerId;
            job.assignedWorkerName = worker.fullName;
            job.assignmentDate = new Date().toISOString();
            
            // Save updated job
            const updateJobTx = db.transaction(['jobs'], 'readwrite');
            const updateJobStore = updateJobTx.objectStore('jobs');
            const updateJobRequest = updateJobStore.put(job);
            
            updateJobRequest.onsuccess = () => {
                showSuccessMessage(`Job "${job.jobTitle}" assigned to ${worker.fullName} successfully!`);
                displayAdminJobs();
                updateDashboardStats();
            };
        } catch (error) {
            console.error('Error assigning worker to job:', error);
            showErrorMessage('Failed to assign worker to job');
        }
    }

    function matchJobWithWorkers(job) {
        // In a real app, this would be a server-side process
        // that matches jobs with suitable workers based on various criteria
        console.log(`Matching job "${job.jobTitle}" with suitable workers...`);
        
        // Simulate matching process
        setTimeout(() => {
            if (Math.random() > 0.3) { // 70% chance of finding matches
                const matchCount = Math.floor(Math.random() * 5) + 1;
                showSuccessMessage(`Found ${matchCount} potential workers for your job!`);
                
                if ('Notification' in window && Notification.permission === 'granted') {
                    new Notification('Job Matches Found', {
                        body: `We found ${matchCount} workers for your "${job.jobTitle}" job. Check your dashboard.`
                    });
                }
            }
        }, 3000);
    }

    // Show success message
    function showSuccessMessage(message) {
        const successMessage = document.getElementById('successMessage');
        successMessage.textContent = message;
        successMessage.style.display = 'block';
        
        setTimeout(() => {
            successMessage.style.display = 'none';
        }, 3000);
    }
    
    // Show error message
    function showErrorMessage(message) {
        // Create an error message element if it doesn't exist
        let errorMessage = document.getElementById('errorMessage');
        
        if (!errorMessage) {
            errorMessage = document.createElement('div');
            errorMessage.id = 'errorMessage';
            errorMessage.style.display = 'none';
            errorMessage.style.position = 'fixed';
            errorMessage.style.top = '20px';
            errorMessage.style.right = '20px';
            errorMessage.style.backgroundColor = 'var(--danger-color)';
            errorMessage.style.color = 'var(--white)';
            errorMessage.style.padding = '1rem 1.5rem';
            errorMessage.style.borderRadius = '6px';
            errorMessage.style.boxShadow = 'var(--shadow)';
            errorMessage.style.zIndex = '1003';
            errorMessage.style.animation = 'slideIn 0.3s, slideOut 0.3s 2.7s forwards';
            
            document.body.appendChild(errorMessage);
        }
        
        errorMessage.textContent = message;
        errorMessage.style.display = 'block';
        
        setTimeout(() => {
            errorMessage.style.display = 'none';
        }, 3000);
    }

    // Helper functions
    function debounce(func, wait) {
        let timeout;
        return function(...args) {
            clearTimeout(timeout);
            timeout = setTimeout(() => func.apply(this, args), wait);
        };
    }

    function formatDate(dateString) {
        if (!dateString) return 'Not specified';
        const options = { year: 'numeric', month: 'short', day: 'numeric' };
        return new Date(dateString).toLocaleDateString(undefined, options);
    }

    function generateRatingStars(rating) {
        const fullStars = Math.floor(rating);
        const hasHalfStar = rating % 1 >= 0.5;
        let stars = '';
        
        for (let i = 0; i < fullStars; i++) {
            stars += '<i class="fas fa-star"></i>';
        }
        
        if (hasHalfStar) {
            stars += '<i class="fas fa-star-half-alt"></i>';
        }
        
        const emptyStars = 5 - fullStars - (hasHalfStar ? 1 : 0);
        for (let i = 0; i < emptyStars; i++) {
            stars += '<i class="far fa-star"></i>';
        }
        
        return stars;
    }

    // Request notification permission
    if ('Notification' in window) {
        Notification.requestPermission().then(permission => {
            console.log('Notification permission:', permission);
        });
    }

    // Check for saved user session
    const savedUser = JSON.parse(localStorage.getItem('currentUser') || sessionStorage.getItem('currentUser'));
    if (savedUser) {
        currentUser = savedUser;
        updateUIForLoggedInAdmin();
    }

    // Initialize the page with home content
    showSection('home');
});

// Service Worker for offline support
if ('serviceWorker' in navigator) {
    const swCode = `
        const CACHE_NAME = 'truley-workers-v1';
        const urlsToCache = [
            '/',
            '/index.html',
            '/styles/main.css',
            '/scripts/main.js',
            '/images/logo.png',
            'https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css',
            'https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap'
        ];

        self.addEventListener('install', event => {
            event.waitUntil(
                caches.open(CACHE_NAME)
                    .then(cache => cache.addAll(urlsToCache))
            );
        });

        self.addEventListener('fetch', event => {
            event.respondWith(
                caches.match(event.request)
                    .then(response => response || fetch(event.request))
            );
        });
    `;
    
    const blob = new Blob([swCode], { type: 'application/javascript' });
    const swUrl = URL.createObjectURL(blob);
    
    // In a real app, you would register an actual service worker file
    // navigator.serviceWorker.register('sw.js');
}        
    </script>
</body>

</html>